"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[342],{2342:function(e,a,t){t.d(a,{Z:function(){return Layout}});var r=t(5893),o=t(7294),s=t(1664),i=t.n(s),n=t(1163),l=t(7016),c=t(4295),d=t.n(c);let exportToExcel=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"beef_sync_export";try{let t=new(d()).Workbook,r=t.addWorksheet("Animais");r.columns=[{header:"ID",key:"ID",width:8},{header:"S\xe9rie",key:"S\xe9rie",width:10},{header:"RG",key:"RG",width:10},{header:"Sexo",key:"Sexo",width:10},{header:"Ra\xe7a",key:"Ra\xe7a",width:12},{header:"Data Nascimento",key:"Data Nascimento",width:15},{header:"Idade (meses)",key:"Idade (meses)",width:12},{header:"Situa\xe7\xe3o",key:"Situa\xe7\xe3o",width:12},{header:"Custo Total (R$)",key:"Custo Total (R$)",width:15},{header:"Valor Venda (R$)",key:"Valor Venda (R$)",width:15},{header:"Valor Real (R$)",key:"Valor Real (R$)",width:15},{header:"Pai",key:"Pai",width:12},{header:"M\xe3e",key:"M\xe3e",width:12},{header:"Av\xf4 Materno",key:"Av\xf4 Materno",width:12},{header:"Receptora",key:"Receptora",width:12},{header:"\xc9 FIV",key:"\xc9 FIV",width:8},{header:"Qtd Custos",key:"Qtd Custos",width:10}],e.forEach(e=>{r.addRow(e)});let o=r.getRow(1);o.eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF4472C4"}},e.font={color:{argb:"FFFFFFFF"},bold:!0},e.alignment={horizontal:"center",vertical:"middle"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),r.eachRow((e,a)=>{a>1&&e.eachCell(e=>{e.alignment={horizontal:"center",vertical:"middle"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})});let s=await t.xlsx.writeBuffer(),i=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=window.URL.createObjectURL(i),l=document.createElement("a");return l.href=n,l.download="".concat(a,".xlsx"),document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(n),!0}catch(e){return console.error("Erro ao exportar para Excel:",e),!1}};var m=t(9577),x=t(2237),h=t(8974),g=t(63),u=t(8680),f=t(3658),p=t(1113),b=t(7272),y=t(2940),N=t(5837),v=t(3564),w=t(2281),k=t(9633),D=t(2418),j=t(3448),A=t(434),E=t(9927),C=t(6249),S=t(5263),T=t(1415);function Sidebar(e){let{isOpen:a,setIsOpen:t}=e,s=(0,n.useRouter)(),{user:c,isDeveloper:d,isConsultant:I,checkPermission:R}=(0,l.aC)(),[_,L]=(0,o.useState)(!1),[M,O]=(0,o.useState)(""),Z=[{name:"Dashboard",href:"/",icon:x.Z},{name:"Editar Animal",href:"/animals",icon:h.Z},{name:"Reprodu\xe7\xe3o",href:"/reproduction",icon:g.Z},{name:"Gesta\xe7\xf5es",href:"/gestacao",icon:u.Z},{name:"Relat\xf3rios Gr\xe1ficos",href:"/reports",icon:f.Z},{name:"Usu\xe1rios",href:"/users",icon:p.Z},{name:"Configura\xe7\xf5es",href:"/settings",icon:b.Z}],P=[{name:"Dashboards",href:"/",icon:x.Z},{name:"Mais Ideias",href:"/dashboard-new",icon:y.Z},{name:"Dados de Vendas",href:"/vendas",icon:N.Z},{name:"Relat\xf3rios Gerais",href:"/reports",icon:v.Z},{name:"An\xe1lises Avan\xe7adas",href:"/dashboard-test",icon:w.Z},{name:"Buscar Animal",href:"/animals",icon:k.Z},{name:"Relat\xf3rio BI",href:"/reports",icon:f.Z},{name:"Feedback Sistema",href:"/feedback",icon:D.Z}],G=[{name:"Novo Registro",icon:u.Z,action:"new"},{name:"Calcular Custo",icon:j.Z,action:"calculate"},{name:"Buscar Animal",icon:k.Z,action:"search"},{name:"Ver Gr\xe1ficos",icon:f.Z,action:"charts"},{name:"Exportar Excel",icon:A.Z,action:"export"},{name:"Importar Excel",icon:E.Z,action:"import"},{name:"Limpar Campos",icon:C.Z,action:"clear"},{name:"Salvar Dados",icon:S.Z,action:"save"}],F=[{name:"Ver Dashboards",icon:x.Z,action:"dashboard"},{name:"Buscar Animal",icon:k.Z,action:"search"},{name:"Relat\xf3rios",icon:f.Z,action:"reports"},{name:"An\xe1lises",icon:w.Z,action:"analytics"},{name:"Feedback",icon:D.Z,action:"feedback"},{name:"Dados Vendas",icon:N.Z,action:"sales"}],U=d()?Z:P,V=d()?G:F,showNotificationMessage=e=>{O(e),L(!0),setTimeout(()=>L(!1),3e3)},handleQuickAction=e=>{switch(e){case"new":s.push("/animals"),showNotificationMessage("Redirecionando para cadastro de novo animal...");break;case"calculate":showNotificationMessage("Calculando custos de todos os animais..."),setTimeout(()=>{showNotificationMessage("C\xe1lculo de custos conclu\xeddo!")},2e3);break;case"search":s.push("/animals"),showNotificationMessage("Abrindo busca de animais...");break;case"charts":s.push("/reports"),showNotificationMessage("Carregando relat\xf3rios gr\xe1ficos...");break;case"export":if(!d()){showNotificationMessage("❌ Apenas desenvolvedores podem exportar dados");return}showNotificationMessage("Exportando dados para Excel...");try{exportToExcel([],"beef_sync_animais_".concat(new Date().toISOString().split("T")[0])).then(e=>{e?setTimeout(()=>{showNotificationMessage("✅ Arquivo Excel exportado com sucesso!")},1e3):setTimeout(()=>{showNotificationMessage("❌ Erro ao exportar arquivo Excel")},1e3)}).catch(e=>{console.error("Erro na exporta\xe7\xe3o:",e),setTimeout(()=>{showNotificationMessage("❌ Erro ao exportar arquivo Excel")},1e3)})}catch(e){console.error("Erro na exporta\xe7\xe3o:",e),setTimeout(()=>{showNotificationMessage("❌ Erro ao exportar arquivo Excel")},1e3)}break;case"import":if(!d()){showNotificationMessage("❌ Apenas desenvolvedores podem importar dados");return}s.push("/animals?openImporter=true"),showNotificationMessage("\uD83D\uDE80 Redirecionando para importa\xe7\xe3o de animais...");break;case"clear":if(!d()){showNotificationMessage("❌ Apenas desenvolvedores podem limpar campos");return}confirm("Tem certeza que deseja limpar todos os campos?")&&showNotificationMessage("Campos limpos com sucesso!");break;case"save":if(!d()){showNotificationMessage("❌ Apenas desenvolvedores podem salvar dados");return}showNotificationMessage("Salvando dados..."),setTimeout(()=>{showNotificationMessage("Dados salvos com sucesso!")},1500);break;case"dashboard":s.push("/"),showNotificationMessage("Carregando dashboards...");break;case"reports":s.push("/reports"),showNotificationMessage("Carregando relat\xf3rios...");break;case"analytics":s.push("/dashboard-test"),showNotificationMessage("Carregando an\xe1lises avan\xe7adas...");break;case"feedback":s.push("/feedback"),showNotificationMessage("Abrindo sistema de feedback...");break;case"sales":s.push("/vendas"),showNotificationMessage("Carregando dados de vendas...");break;default:showNotificationMessage("A\xe7\xe3o n\xe3o implementada")}};return(0,r.jsxs)(r.Fragment,{children:[a&&(0,r.jsx)("div",{className:"fixed inset-0 z-40 bg-black bg-opacity-50 lg:hidden",onClick:()=>t(!1)}),(0,r.jsxs)("div",{className:"\n        fixed inset-y-0 left-0 z-50 w-64 bg-white dark:bg-gray-800 shadow-lg transform transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0\n        ".concat(a?"translate-x-0":"-translate-x-full","\n      "),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between h-16 px-4 border-b border-gray-200 dark:border-gray-700",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-primary-600 dark:text-primary-400",children:"\uD83D\uDC2E Beef_Sync"}),(0,r.jsx)("button",{onClick:()=>t(!1),className:"lg:hidden p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700",children:(0,r.jsx)(T.Z,{className:"h-6 w-6"})})]}),(0,r.jsx)("div",{className:"px-4 py-2 bg-gray-50 dark:bg-gray-700",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:(null==c?void 0:c.name)||"Usu\xe1rio"}),(0,r.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(d()?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":(null==c?void 0:c.role)==="visitor"?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"),children:d()?"Desenvolvedor":(null==c?void 0:c.role)==="visitor"?"Visitante":"Consultor"})]})}),(0,r.jsx)("nav",{className:"mt-5 px-2 space-y-1",children:U.map(e=>{let a=s.pathname===e.href;return(0,r.jsxs)(i(),{href:e.href,className:"\n                  group flex items-center px-2 py-2 text-sm font-medium rounded-md transition-colors\n                  ".concat(a?"bg-primary-100 dark:bg-primary-900 text-primary-900 dark:text-primary-100":"text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white","\n                "),children:[(0,r.jsx)(e.icon,{className:"mr-3 h-6 w-6"}),e.name]},e.name)})}),(0,r.jsx)("div",{className:"mt-6 px-2",children:(0,r.jsx)(m.Z,{})}),(0,r.jsxs)("div",{className:"mt-8 px-2",children:[(0,r.jsx)("h3",{className:"px-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:d()?"A\xe7\xf5es R\xe1pidas":"A\xe7\xf5es Dispon\xedveis"}),(0,r.jsx)("div",{className:"mt-2 space-y-1",children:V.map(e=>(0,r.jsxs)("button",{onClick:()=>handleQuickAction(e.action),className:"group flex items-center w-full px-2 py-2 text-sm font-medium text-gray-600 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white transition-colors",children:[(0,r.jsx)(e.icon,{className:"mr-3 h-5 w-5"}),e.name]},e.name))})]})]}),_&&(0,r.jsx)("div",{className:"fixed top-4 right-4 z-50 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg transition-all duration-300",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"mr-2",children:"✅"}),(0,r.jsx)("div",{className:"text-sm font-medium",children:M})]})})]})}var I=t(3407),R=t(4346),_=t(3771),L=t(97),M=t(4412),O=t(7377),Z=t(50),P=t(65);function GTANotificationCenter(e){let{userId:a}=e,[t,s]=(0,o.useState)([]),[i,n]=(0,o.useState)(!0),[l,c]=(0,o.useState)("all"),[d,m]=(0,o.useState)("all"),[x,h]=(0,o.useState)(!1),[g,u]=(0,o.useState)(null),[f,p]=(0,o.useState)("");(0,o.useEffect)(()=>{loadNotifications()},[l,d]);let loadNotifications=async()=>{try{n(!0);let e={};"all"!==l&&(e.status=l.toUpperCase()),"all"!==d&&(e.tipo=d);let a=await P.Z.getNotifications(e);s(a)}catch(e){console.error("Erro ao carregar notifica\xe7\xf5es:",e)}finally{n(!1)}},markAsRead=async e=>{try{await P.Z.markAsRead(e),s(a=>a.map(a=>a.id===e?{...a,status:"LIDA",dataLida:new Date().toISOString()}:a))}catch(e){console.error("Erro ao marcar como lida:",e)}},markAsResolved=async e=>{try{await P.Z.markAsResolved(e,f),s(a=>a.map(a=>a.id===e?{...a,status:"RESOLVIDA",dataResolvida:new Date().toISOString()}:a)),h(!1),u(null),p("")}catch(e){console.error("Erro ao marcar como resolvida:",e)}},deleteNotification=async e=>{try{await P.Z.deleteNotification(e),s(a=>a.filter(a=>a.id!==e))}catch(e){console.error("Erro ao excluir notifica\xe7\xe3o:",e)}},getPriorityColor=e=>{switch(e){case"ALTA":return"border-red-500 bg-red-50 dark:bg-red-900/20";case"MEDIA":return"border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20";case"BAIXA":return"border-blue-500 bg-blue-50 dark:bg-blue-900/20";default:return"border-gray-500 bg-gray-50 dark:bg-gray-700"}},getTypeIcon=e=>{switch(e){case"GTA_FOLLOWUP":return"\uD83D\uDCDE";case"NASCIMENTO":return"\uD83D\uDC04";case"VENDA":return"\uD83D\uDCB0";case"GESTACAO":return"\uD83E\uDD30";case"PARTO":return"\uD83D\uDC23";case"VACINACAO":return"\uD83D\uDC89";case"PESAGEM":return"⚖️";case"SYSTEM_ALERT":return"\uD83D\uDD14";default:return"\uD83D\uDCCB"}},getStatusColor=e=>{switch(e){case"PENDENTE":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400";case"LIDA":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400";case"RESOLVIDA":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";case"CANCELADA":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},formatTimeAgo=e=>{let a=new Date,t=new Date(e),r=Math.floor((a-t)/6e4);return r<1?"Agora":r<60?"".concat(r,"min atr\xe1s"):r<1440?"".concat(Math.floor(r/60),"h atr\xe1s"):"".concat(Math.floor(r/1440),"d atr\xe1s")},openResolveModal=e=>{u(e),h(!0)},handleCall=e=>{let a=e.dados?JSON.parse(e.dados):{},t=a.compradorTelefone||"";t?window.open("tel:".concat(t)):alert("Telefone do cliente n\xe3o dispon\xedvel")},handleWhatsApp=e=>{let a=e.dados?JSON.parse(e.dados):{},t=a.compradorTelefone||"";if(t){let r=encodeURIComponent("Ol\xe1! Estou entrando em contato sobre a GTA ".concat(a.gtaNumero,". ").concat(e.mensagem));window.open("https://wa.me/".concat(t.replace(/\D/g,""),"?text=").concat(r))}else alert("Telefone do cliente n\xe3o dispon\xedvel")},b=t.filter(e=>"PENDENTE"===e.status).length,N=t.filter(e=>"ALTA"===e.prioridade&&"PENDENTE"===e.status).length;return(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-4 sm:mb-0",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(M.Z,{className:"h-8 w-8 text-blue-600"}),b>0&&(0,r.jsx)("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:b})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Notifica\xe7\xf5es do Sistema"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[b," pendente",1!==b?"s":""," • ",N," alta prioridade"]})]})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2",children:[(0,r.jsx)("select",{value:d,onChange:e=>m(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white text-sm",children:[{value:"all",label:"Todas",icon:"\uD83D\uDCCB"},{value:"GTA_FOLLOWUP",label:"GTAs",icon:"\uD83D\uDCDE"},{value:"NASCIMENTO",label:"Nascimentos",icon:"\uD83D\uDC04"},{value:"VENDA",label:"Vendas",icon:"\uD83D\uDCB0"},{value:"GESTACAO",label:"Gesta\xe7\xf5es",icon:"\uD83E\uDD30"},{value:"PARTO",label:"Partos",icon:"\uD83D\uDC23"},{value:"VACINACAO",label:"Vacina\xe7\xf5es",icon:"\uD83D\uDC89"},{value:"PESAGEM",label:"Pesagens",icon:"⚖️"},{value:"SYSTEM_ALERT",label:"Sistema",icon:"\uD83D\uDD14"}].map(e=>(0,r.jsxs)("option",{value:e.value,children:[e.icon," ",e.label]},e.value))}),(0,r.jsxs)("select",{value:l,onChange:e=>c(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white text-sm",children:[(0,r.jsx)("option",{value:"all",children:"Todas"}),(0,r.jsx)("option",{value:"pending",children:"Pendentes"}),(0,r.jsx)("option",{value:"read",children:"Lidas"}),(0,r.jsx)("option",{value:"resolved",children:"Resolvidas"})]})]})]}),(0,r.jsx)("div",{className:"max-h-96 overflow-y-auto",children:i?(0,r.jsxs)("div",{className:"p-6 text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Carregando notifica\xe7\xf5es..."})]}):0===t.length?(0,r.jsxs)("div",{className:"p-6 text-center",children:[(0,r.jsx)(M.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"all"===l?"Nenhuma notifica\xe7\xe3o encontrada":"Nenhuma notifica\xe7\xe3o ".concat(l)})]}):(0,r.jsx)("div",{className:"space-y-2 p-4",children:t.map(e=>(0,r.jsx)("div",{className:"p-3 sm:p-4 rounded-lg border-l-4 transition-all hover:shadow-md ".concat("PENDENTE"===e.status?getPriorityColor(e.prioridade):"bg-gray-50 dark:bg-gray-700 opacity-75"),children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3 flex-1 min-w-0",children:[(0,r.jsx)("div",{className:"text-2xl flex-shrink-0",children:getTypeIcon(e.tipo)}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white text-sm sm:text-base truncate",children:e.titulo}),"PENDENTE"===e.status&&(0,r.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2 line-clamp-2",children:e.mensagem}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[(0,r.jsx)("span",{children:formatTimeAgo(e.dataCriacao)}),(0,r.jsx)("span",{className:"px-2 py-1 rounded-full ".concat(getStatusColor(e.status)),children:e.status}),(0,r.jsx)("span",{className:"px-2 py-1 rounded-full ".concat("ALTA"===e.prioridade?"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400":"MEDIA"===e.prioridade?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400":"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400"),children:e.prioridade})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1 sm:space-x-2 flex-shrink-0",children:["PENDENTE"===e.status&&(0,r.jsxs)(r.Fragment,{children:["GTA_FOLLOWUP"===e.tipo&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>handleCall(e),className:"p-1.5 sm:p-2 text-green-600 hover:bg-green-100 dark:hover:bg-green-900/20 rounded-lg transition-colors",title:"Ligar",children:(0,r.jsx)(O.Z,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:()=>handleWhatsApp(e),className:"p-1.5 sm:p-2 text-green-600 hover:bg-green-100 dark:hover:bg-green-900/20 rounded-lg transition-colors",title:"WhatsApp",children:(0,r.jsx)(D.Z,{className:"h-4 w-4"})})]}),(0,r.jsx)("button",{onClick:()=>markAsRead(e.id),className:"p-1.5 sm:p-2 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:"Marcar como lida",children:(0,r.jsx)(y.Z,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:()=>openResolveModal(e),className:"p-1.5 sm:p-2 text-green-600 hover:bg-green-100 dark:hover:bg-green-900/20 rounded-lg transition-colors",title:"Marcar como resolvida",children:(0,r.jsx)(Z.Z,{className:"h-4 w-4"})})]}),(0,r.jsx)("button",{onClick:()=>deleteNotification(e.id),className:"p-1.5 sm:p-2 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Excluir",children:(0,r.jsx)(C.Z,{className:"h-4 w-4"})})]})]})},e.id))})}),x&&g&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Resolver Notifica\xe7\xe3o"}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:[(0,r.jsx)("strong",{children:"T\xedtulo:"})," ",g.titulo]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,r.jsx)("strong",{children:"Mensagem:"})," ",g.mensagem]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Observa\xe7\xf5es (opcional)"}),(0,r.jsx)("textarea",{value:f,onChange:e=>p(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",rows:3,placeholder:"Adicione observa\xe7\xf5es sobre a resolu\xe7\xe3o..."})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:()=>{h(!1),u(null),p("")},className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Cancelar"}),(0,r.jsx)("button",{onClick:()=>markAsResolved(g.id),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"✅ Resolver"})]})]})})})]})}function NotificationWidget(e){let{userId:a}=e,[t,s]=(0,o.useState)(!1),[i,n]=(0,o.useState)(0),[l,c]=(0,o.useState)(0);(0,o.useEffect)(()=>{loadNotificationCounts();let e=setInterval(loadNotificationCounts,3e4);return()=>clearInterval(e)},[]);let loadNotificationCounts=async()=>{try{let e=await fetch("/api/notifications?status=PENDENTE",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("beef_sync_token"))}});if(e.ok){let a=await e.json();n(a.length),c(a.filter(e=>"ALTA"===e.prioridade).length)}}catch(e){console.error("Erro ao carregar contadores de notifica\xe7\xe3o:",e)}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("button",{onClick:()=>s(!t),className:"relative p-2 sm:p-3 bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 border border-gray-200 dark:border-gray-700",children:[(0,r.jsx)(M.Z,{className:"h-5 w-5 sm:h-6 sm:w-6 text-gray-600 dark:text-gray-400"}),i>0&&(0,r.jsx)("span",{className:"absolute -top-1 -right-1 sm:-top-2 sm:-right-2 bg-red-500 text-white text-xs rounded-full h-4 w-4 sm:h-5 sm:w-5 flex items-center justify-center font-bold",children:i>99?"99+":i}),l>0&&0===i&&(0,r.jsx)("span",{className:"absolute -top-1 -right-1 sm:-top-2 sm:-right-2 bg-orange-500 text-white text-xs rounded-full h-4 w-4 sm:h-5 sm:w-5 flex items-center justify-center font-bold",children:l})]}),i>0&&(0,r.jsxs)("div",{className:"absolute bottom-full right-0 mb-2 px-3 py-2 bg-gray-900 text-white text-sm rounded-lg shadow-lg whitespace-nowrap z-50 hidden sm:block",children:[i," notifica\xe7\xe3o",1!==i?"es":""," pendente",1!==i?"s":"",l>0&&(0,r.jsxs)("span",{className:"block text-orange-300",children:[l," de alta prioridade"]})]})]}),t&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl sm:rounded-2xl shadow-2xl w-full max-w-4xl max-h-[95vh] sm:max-h-[90vh] overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-blue-600 to-indigo-600",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(M.Z,{className:"h-6 w-6 sm:h-8 sm:w-8 text-white"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg sm:text-2xl font-bold text-white",children:"\uD83D\uDD14 Centro de Notifica\xe7\xf5es"}),(0,r.jsx)("p",{className:"text-blue-100 text-sm sm:text-base",children:"Follow-up de GTAs e alertas do sistema"})]})]}),(0,r.jsx)("button",{onClick:()=>s(!1),className:"p-2 hover:bg-white/20 rounded-lg transition-colors text-white text-xl sm:text-2xl font-bold",children:(0,r.jsx)(T.Z,{className:"h-5 w-5 sm:h-6 sm:w-6"})})]}),(0,r.jsx)("div",{className:"p-4 sm:p-6 overflow-y-auto max-h-[calc(95vh-80px)] sm:max-h-[calc(90vh-120px)]",children:(0,r.jsx)(GTANotificationCenter,{userId:a})})]})})]})}function Header(e){let{darkMode:a,toggleDarkMode:t,setSidebarOpen:s,onLogout:i}=e,[l,c]=(0,o.useState)(!1),[d,m]=(0,o.useState)({name:"Usu\xe1rio",role:"Administrador",avatar:null}),x=(0,n.useRouter)();return(0,o.useEffect)(()=>{let loadUserData=()=>{m({name:localStorage.getItem("beef_sync_user_name")||"Usu\xe1rio",role:localStorage.getItem("beef_sync_user_role")||"Administrador",avatar:null})};loadUserData();let handleStorageChange=e=>{("beef_sync_user_name"===e.key||"beef_sync_user_role"===e.key)&&loadUserData()};window.addEventListener("storage",handleStorageChange);let handleCustomUpdate=()=>loadUserData();return window.addEventListener("userDataUpdated",handleCustomUpdate),()=>{window.removeEventListener("storage",handleStorageChange),window.removeEventListener("userDataUpdated",handleCustomUpdate)}},[]),(0,r.jsx)("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:(0,r.jsxs)("div",{className:"flex items-center justify-between h-16 px-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("button",{onClick:()=>s(!0),className:"lg:hidden p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700",children:(0,r.jsx)(I.Z,{className:"h-6 w-6"})}),(0,r.jsx)("div",{className:"ml-4 lg:ml-0",children:(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Sistema de Gest\xe3o Bovina"})})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("button",{onClick:t,className:"p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700",children:a?(0,r.jsx)(R.Z,{className:"h-6 w-6"}):(0,r.jsx)(_.Z,{className:"h-6 w-6"})}),(0,r.jsx)(NotificationWidget,{userId:d.id||"user123"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("button",{onClick:()=>c(!l),className:"flex items-center space-x-2 p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700",children:[(0,r.jsx)(L.Z,{className:"h-8 w-8"}),(0,r.jsxs)("div",{className:"hidden md:block text-left",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:d.name}),(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:d.role})]})]}),l&&(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg py-1 z-50 border border-gray-200 dark:border-gray-700",children:[(0,r.jsx)("button",{onClick:()=>{c(!1),x.push("/profile")},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Perfil"}),(0,r.jsx)("button",{onClick:()=>{c(!1),x.push("/settings")},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Configura\xe7\xf5es"}),(0,r.jsx)("hr",{className:"my-1 border-gray-200 dark:border-gray-700"}),(0,r.jsx)("button",{onClick:()=>{console.log("\uD83D\uDEAA Fazendo logout..."),c(!1),localStorage.removeItem("beef-sync-user"),localStorage.removeItem("beef_sync_user_name"),localStorage.removeItem("beef_sync_user_role"),localStorage.removeItem("beef_sync_user"),sessionStorage.clear(),console.log("✅ Logout realizado com sucesso"),i?i():x.push("/login")},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Sair"})]})]})]})]})})}var G=t(9630);function Layout(e){let{children:a,onLogout:t}=e,[s,i]=(0,o.useState)(!1),{state:n,actions:l}=(0,G.qD)();return(0,r.jsxs)("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[(0,r.jsx)(Sidebar,{isOpen:s,setIsOpen:i}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,r.jsx)(Header,{darkMode:"dark"===n.theme,toggleDarkMode:l.toggleTheme,setSidebarOpen:i,onLogout:t}),(0,r.jsx)("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-50 dark:bg-gray-900 p-6",children:a})]})]})}},65:function(e,a,t){let NotificationService=class NotificationService{async createGTAFollowUp(e,a){let t={confirmação_chegada:{titulo:"\uD83D\uDCDE Confirma\xe7\xe3o de Chegada - GTA",mensagem:"Ligar para ".concat(e.compradorNome||"cliente"," para confirmar se os animais da GTA ").concat(e.numero," chegaram bem"),prioridade:"ALTA",diasOffset:20},verificação_satisfação:{titulo:"\uD83E\uDD1D Follow-up Satisfa\xe7\xe3o - GTA",mensagem:"Ligar para ".concat(e.compradorNome||"cliente"," para verificar satisfa\xe7\xe3o com os animais da GTA ").concat(e.numero),prioridade:"MEDIA",diasOffset:60},oferta_novos_animais:{titulo:"\uD83C\uDFAF Oferta Novos Animais - GTA",mensagem:"Ligar para ".concat(e.compradorNome||"cliente"," para oferecer novos animais (GTA ").concat(e.numero,")"),prioridade:"MEDIA",diasOffset:240},lembrete_5_dias:{titulo:"⏰ Lembrete Follow-up - GTA",mensagem:"Em 5 dias: Ligar para ".concat(e.compradorNome||"cliente"," sobre GTA ").concat(e.numero),prioridade:"ALTA",diasOffset:-5}},r=t[a];if(!r)throw Error("Tipo de follow-up inv\xe1lido: ".concat(a));let o=new Date(e.dataEmissao);o.setDate(o.getDate()+r.diasOffset);let s={tipo:"GTA_FOLLOWUP",titulo:r.titulo,mensagem:r.mensagem,prioridade:r.prioridade,dataAgendada:o.toISOString(),gtaId:e.id,dados:JSON.stringify({gtaNumero:e.numero,compradorNome:e.compradorNome,compradorTelefone:e.compradorTelefone,followUpType:a,animais:e.animais||[]})};return this.createNotification(s)}async createBirthNotification(e){let a={tipo:"NASCIMENTO",titulo:"\uD83D\uDC04 Novo Nascimento - Animal",mensagem:"Animal ".concat(e.serie||e.brinco||"N/A"," nasceu em ").concat(new Date(e.dataNascimento).toLocaleDateString("pt-BR")),prioridade:"MEDIA",dados:JSON.stringify({animalId:e.id,serie:e.serie,brinco:e.brinco,sexo:e.sexo,dataNascimento:e.dataNascimento,mae:e.mae,pai:e.pai})};return this.createNotification(a)}async createSaleNotification(e){var a;let t={tipo:"VENDA",titulo:"\uD83D\uDCB0 Venda Realizada",mensagem:"Venda de ".concat(e.animalNome||"animal"," por R$ ").concat((null===(a=e.valor)||void 0===a?void 0:a.toLocaleString("pt-BR"))||"N/A"," para ").concat(e.comprador||"cliente"),prioridade:"MEDIA",dados:JSON.stringify({animalId:e.animalId,animalNome:e.animalNome,valor:e.valor,comprador:e.comprador,dataVenda:e.dataVenda,formaPagamento:e.formaPagamento})};return this.createNotification(t)}async createGestationNotification(e){let a={tipo:"GESTACAO",titulo:"\uD83E\uDD30 Nova Gesta\xe7\xe3o",mensagem:"Animal ".concat(e.animalNome||"N/A"," confirmada gestante - Data prevista: ").concat(new Date(e.dataPrevista).toLocaleDateString("pt-BR")),prioridade:"MEDIA",dados:JSON.stringify({animalId:e.animalId,animalNome:e.animalNome,dataConfirmacao:e.dataConfirmacao,dataPrevista:e.dataPrevista,touro:e.touro})};return this.createNotification(a)}async createPartoNotification(e){let a={tipo:"PARTO",titulo:"\uD83D\uDC23 Parto Realizado",mensagem:"Animal ".concat(e.animalNome||"N/A"," pariu em ").concat(new Date(e.dataParto).toLocaleDateString("pt-BR")," - ").concat(e.quantidadeFilhotes||1," filhote(s)"),prioridade:"ALTA",dados:JSON.stringify({animalId:e.animalId,animalNome:e.animalNome,dataParto:e.dataParto,quantidadeFilhotes:e.quantidadeFilhotes,observacoes:e.observacoes})};return this.createNotification(a)}async createVaccinationNotification(e){let a={tipo:"VACINACAO",titulo:"\uD83D\uDC89 Vacina\xe7\xe3o Realizada",mensagem:"Animal ".concat(e.animalNome||"N/A"," vacinado com ").concat(e.vacina||"vacina"," em ").concat(new Date(e.dataVacinacao).toLocaleDateString("pt-BR")),prioridade:"MEDIA",dados:JSON.stringify({animalId:e.animalId,animalNome:e.animalNome,vacina:e.vacina,dataVacinacao:e.dataVacinacao,proximaVacinacao:e.proximaVacinacao})};return this.createNotification(a)}async createWeightNotification(e){let a={tipo:"PESAGEM",titulo:"⚖️ Pesagem Realizada",mensagem:"Animal ".concat(e.animalNome||"N/A"," pesado: ").concat(e.peso,"kg em ").concat(new Date(e.dataPesagem).toLocaleDateString("pt-BR")),prioridade:"BAIXA",dados:JSON.stringify({animalId:e.animalId,animalNome:e.animalNome,peso:e.peso,dataPesagem:e.dataPesagem,ganhoPeso:e.ganhoPeso})};return this.createNotification(a)}async createSystemNotification(e){let a={tipo:"SYSTEM_ALERT",titulo:e.titulo||"\uD83D\uDD14 Alerta do Sistema",mensagem:e.mensagem||"Notifica\xe7\xe3o do sistema",prioridade:e.prioridade||"BAIXA",dados:JSON.stringify({systemEvent:e.event,timestamp:new Date().toISOString(),...e})};return this.createNotification(a)}async createNotification(e){try{let a=await fetch(this.baseUrl,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("beef_sync_token"))},body:JSON.stringify(e)});if(!a.ok)throw Error("Erro ao criar notifica\xe7\xe3o");return await a.json()}catch(e){throw console.error("Erro ao criar notifica\xe7\xe3o:",e),e}}async getNotifications(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let a=new URLSearchParams(e),t=await fetch("".concat(this.baseUrl,"?").concat(a),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("beef_sync_token"))}});if(!t.ok)throw Error("Erro ao buscar notifica\xe7\xf5es");return await t.json()}catch(e){throw console.error("Erro ao buscar notifica\xe7\xf5es:",e),e}}async markAsRead(e){try{let a=await fetch("".concat(this.baseUrl,"/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("beef_sync_token"))},body:JSON.stringify({status:"LIDA"})});if(!a.ok)throw Error("Erro ao marcar notifica\xe7\xe3o como lida");return await a.json()}catch(e){throw console.error("Erro ao marcar notifica\xe7\xe3o como lida:",e),e}}async markAsResolved(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{let t=await fetch("".concat(this.baseUrl,"/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("beef_sync_token"))},body:JSON.stringify({status:"RESOLVIDA",observacoes:a})});if(!t.ok)throw Error("Erro ao marcar notifica\xe7\xe3o como resolvida");return await t.json()}catch(e){throw console.error("Erro ao marcar notifica\xe7\xe3o como resolvida:",e),e}}async deleteNotification(e){try{let a=await fetch("".concat(this.baseUrl,"/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("beef_sync_token"))}});if(!a.ok)throw Error("Erro ao excluir notifica\xe7\xe3o");return await a.json()}catch(e){throw console.error("Erro ao excluir notifica\xe7\xe3o:",e),e}}async createGTAAutomaticNotifications(e){let a=[];try{let t=await this.createGTAFollowUp(e,"lembrete_5_dias");a.push(t);let r=await this.createGTAFollowUp(e,"confirma\xe7\xe3o_chegada");a.push(r);let o=await this.createGTAFollowUp(e,"verifica\xe7\xe3o_satisfa\xe7\xe3o");a.push(o);let s=await this.createGTAFollowUp(e,"oferta_novos_animais");return a.push(s),a}catch(e){throw console.error("Erro ao criar notifica\xe7\xf5es autom\xe1ticas:",e),e}}async getPendingNotifications(){return this.getNotifications({status:"PENDENTE"})}async getHighPriorityNotifications(){return this.getNotifications({prioridade:"ALTA",status:"PENDENTE"})}async getGTANotifications(){return this.getNotifications({tipo:"GTA_FOLLOWUP"})}async getNotificationsByType(e){return this.getNotifications({tipo:e})}constructor(){this.baseUrl="/api/notifications"}};a.Z=new NotificationService}}]);