(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[377],{7624:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/vendas",function(){return t(3824)}])},3777:function(e,a,t){"use strict";t.d(a,{C:function(){return Badge}});var s=t(5893);t(7294);let Badge=e=>{let{children:a,variant:t="default",className:r="",...l}=e;return(0,s.jsx)("span",{className:"".concat("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium transition-colors"," ").concat({default:"bg-blue-600 text-white dark:bg-blue-500 dark:text-white",outline:"border border-gray-300 bg-transparent text-gray-700 dark:border-gray-600 dark:text-gray-300",success:"bg-green-600 text-white dark:bg-green-500 dark:text-white",warning:"bg-yellow-600 text-white dark:bg-yellow-500 dark:text-white",error:"bg-red-600 text-white dark:bg-red-500 dark:text-white",secondary:"bg-gray-600 text-white dark:bg-gray-500 dark:text-white"}[t]," ").concat(r),...l,children:a})}},4491:function(e,a,t){"use strict";t.d(a,{z:function(){return Button}});var s=t(5893);t(7294);let Button=e=>{let{children:a,variant:t="default",size:r="default",className:l="",disabled:i=!1,type:n="button",...d}=e;return(0,s.jsx)("button",{type:n,className:"".concat("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none"," ").concat({default:"bg-blue-600 dark:bg-blue-500 text-white hover:bg-blue-700 dark:hover:bg-blue-600 font-semibold",outline:"border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700 font-medium",ghost:"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-900 dark:text-gray-100 font-medium",destructive:"bg-red-600 dark:bg-red-500 text-white hover:bg-red-700 dark:hover:bg-red-600 font-semibold"}[t]," ").concat({default:"h-10 py-2 px-4 text-sm",sm:"h-9 px-3 text-sm",lg:"h-11 px-8 text-base",icon:"h-10 w-10"}[r]," ").concat(l),disabled:i,...d,children:a})}},794:function(e,a,t){"use strict";t.d(a,{Ol:function(){return CardHeader},Zb:function(){return Card},aY:function(){return CardContent},ll:function(){return CardTitle}});var s=t(5893);t(7294);let Card=e=>{let{children:a,className:t="",...r}=e;return(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm text-gray-900 dark:text-white transition-colors ".concat(t),...r,children:a})},CardHeader=e=>{let{children:a,className:t="",...r}=e;return(0,s.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 ".concat(t),...r,children:a})},CardTitle=e=>{let{children:a,className:t="",...r}=e;return(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white ".concat(t),...r,children:a})},CardContent=e=>{let{children:a,className:t="",...r}=e;return(0,s.jsx)("div",{className:"px-6 py-4 text-gray-900 dark:text-white ".concat(t),...r,children:a})}},6522:function(e,a,t){"use strict";t.d(a,{I:function(){return Input}});var s=t(5893);t(7294);let Input=e=>{let{className:a="",type:t="text",disabled:r=!1,...l}=e;return(0,s.jsx)("input",{type:t,className:"flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ".concat(a),disabled:r,...l})}},3192:function(e,a,t){"use strict";t.d(a,{Bw:function(){return SelectContent},Ph:function(){return Select},Ql:function(){return SelectItem},i4:function(){return SelectTrigger},ki:function(){return SelectValue}});var s=t(5893);t(7294);let Select=e=>{let{children:a,value:t,onValueChange:r,className:l="",disabled:i=!1,...n}=e;return(0,s.jsx)("select",{value:t,onChange:e=>r&&r(e.target.value),disabled:i,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 disabled:opacity-50 disabled:cursor-not-allowed ".concat(l),...n,children:a})},SelectTrigger=e=>{let{children:a,className:t="",...r}=e;return(0,s.jsx)("div",{className:t,...r,children:a})},SelectValue=e=>{let{placeholder:a,className:t="",...r}=e;return(0,s.jsx)("span",{className:t,...r,children:a})},SelectContent=e=>{let{children:a,className:t="",...r}=e;return(0,s.jsx)("div",{className:t,...r,children:a})},SelectItem=e=>{let{children:a,value:t,className:r="",...l}=e;return(0,s.jsx)("option",{value:t,className:r,...l,children:a})}},4207:function(e,a,t){"use strict";t.d(a,{g:function(){return Textarea}});var s=t(5893);t(7294);let Textarea=e=>{let{className:a="",disabled:t=!1,rows:r=3,...l}=e;return(0,s.jsx)("textarea",{rows:r,className:"flex min-h-[80px] w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 ring-offset-white placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ".concat(a),disabled:t,...l})}},3824:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return VendasPage}});var s=t(5893),r=t(7294),l=t(794),i=t(4491),n=t(6522),d=t(3192),c=t(3777),o=t(4207),components_ClientAnalysis=e=>{let{salesData:a=[]}=e,[t,n]=(0,r.useState)([]),[d,o]=(0,r.useState)("all");(0,r.useEffect)(()=>{if(0===a.length)return;let e=a.reduce((e,a)=>{let t=a.client.id;e[t]||(e[t]={client:a.client,sales:[],totalValue:0,totalAnimals:0,lastPurchase:null,frequency:0}),e[t].sales.push(a),e[t].totalValue+=a.totalValue,e[t].totalAnimals+=a.animals.length;let s=new Date(a.saleDate);return(!e[t].lastPurchase||s>new Date(e[t].lastPurchase))&&(e[t].lastPurchase=a.saleDate),e},{}),t=Object.values(e).map(e=>{let a=Math.floor((new Date-new Date(e.lastPurchase))/864e5),t=e.totalValue/e.sales.length,s=e.sales.length,r=0;s>=5?r+=30:s>=3?r+=20:s>=2&&(r+=10),e.totalValue>=5e5?r+=25:e.totalValue>=2e5?r+=20:e.totalValue>=1e5?r+=15:e.totalValue>=5e4&&(r+=10),a<=30?r+=25:a<=60?r+=20:a<=90?r+=15:a<=180&&(r+=10);let l=e.sales.reduce((e,a)=>e+(({Excelente:5,"Muito Bom":4,Bom:3,Regular:2,Ruim:1})[a.satisfaction]||3),0)/e.sales.length,i="Bronze",n="Baixa";(r+=Math.floor(l/5*20))>=80?(i="Diamante",n="Muito Alta"):r>=60?(i="Ouro",n="Alta"):r>=40&&(i="Prata",n="M\xe9dia");let d="Baixo";return a>180?d="Alto":a>90&&(d="M\xe9dio"),{...e,averageTicket:t,purchaseFrequency:s,daysSinceLastPurchase:a,relationshipScore:r,classification:i,priority:n,riskStatus:d,avgSatisfaction:l.toFixed(1)}});t.sort((e,a)=>a.relationshipScore-e.relationshipScore),n(t)},[a]);let formatCurrency=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),getClassificationBadge=e=>{let a={Diamante:(0,s.jsx)(c.C,{className:"bg-purple-600 text-white dark:bg-purple-500 dark:text-white",children:"\uD83D\uDC8E Diamante"}),Ouro:(0,s.jsx)(c.C,{className:"bg-yellow-600 text-white dark:bg-yellow-500 dark:text-white",children:"\uD83E\uDD47 Ouro"}),Prata:(0,s.jsx)(c.C,{className:"bg-gray-600 text-white dark:bg-gray-500 dark:text-white",children:"\uD83E\uDD48 Prata"}),Bronze:(0,s.jsx)(c.C,{className:"bg-orange-600 text-white dark:bg-orange-500 dark:text-white",children:"\uD83E\uDD49 Bronze"})};return a[e]||a.Bronze},getRiskBadge=e=>{let a={Alto:(0,s.jsx)(c.C,{className:"bg-red-600 text-white dark:bg-red-500 dark:text-white",children:"\uD83D\uDEA8 Alto Risco"}),Médio:(0,s.jsx)(c.C,{className:"bg-yellow-600 text-white dark:bg-yellow-500 dark:text-white",children:"⚠️ M\xe9dio Risco"}),Baixo:(0,s.jsx)(c.C,{className:"bg-green-600 text-white dark:bg-green-500 dark:text-white",children:"✅ Baixo Risco"})};return a[e]||a.Baixo},getPriorityColor=e=>{let a={"Muito Alta":"border-l-4 border-purple-500 bg-purple-50 dark:bg-purple-900/20",Alta:"border-l-4 border-red-500 bg-red-50 dark:bg-red-900/20",Média:"border-l-4 border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20",Baixa:"border-l-4 border-green-500 bg-green-50 dark:bg-green-900/20"};return a[e]||a.Baixa},x="all"===d?t:t.filter(e=>e.client.segment===d),g=[...new Set(t.map(e=>e.client.segment))],m=t.slice(0,5),h=t.filter(e=>"Alto"===e.riskStatus),u=t.filter(e=>"Diamante"===e.classification);return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(l.Zb,{className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white",children:(0,s.jsx)(l.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"\uD83D\uDC65 An\xe1lise de Clientes"}),(0,s.jsx)("p",{className:"text-purple-100 text-lg",children:"Classifica\xe7\xe3o e relacionamento com clientes"})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"text-4xl mb-2",children:"\uD83C\uDFAF"}),(0,s.jsxs)(c.C,{variant:"outline",className:"bg-white/20 text-white border-white/30",children:[t.length," clientes"]})]})]})})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,s.jsx)(l.Zb,{className:"bg-white dark:bg-gray-800 border-2 border-purple-200 dark:border-purple-600 shadow-lg",children:(0,s.jsx)(l.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-bold text-gray-600 dark:text-gray-300",children:"Clientes Diamante"}),(0,s.jsx)("p",{className:"text-3xl font-black text-purple-600 dark:text-purple-400",children:u.length})]}),(0,s.jsx)("div",{className:"bg-purple-100 dark:bg-purple-900/30 p-4 rounded-lg",children:(0,s.jsx)("span",{className:"text-3xl",children:"\uD83D\uDC8E"})})]})})}),(0,s.jsx)(l.Zb,{className:"bg-white dark:bg-gray-800 border-2 border-red-200 dark:border-red-600 shadow-lg",children:(0,s.jsx)(l.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-bold text-gray-600 dark:text-gray-300",children:"Alto Risco"}),(0,s.jsx)("p",{className:"text-3xl font-black text-red-600 dark:text-red-400",children:h.length})]}),(0,s.jsx)("div",{className:"bg-red-100 dark:bg-red-900/30 p-4 rounded-lg",children:(0,s.jsx)("span",{className:"text-3xl",children:"\uD83D\uDEA8"})})]})})}),(0,s.jsx)(l.Zb,{className:"bg-white dark:bg-gray-800 border-2 border-green-200 dark:border-green-600 shadow-lg",children:(0,s.jsx)(l.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-bold text-gray-600 dark:text-gray-300",children:"Ticket M\xe9dio"}),(0,s.jsx)("p",{className:"text-3xl font-black text-green-600 dark:text-green-400",children:formatCurrency(t.reduce((e,a)=>e+a.averageTicket,0)/(t.length||1))})]}),(0,s.jsx)("div",{className:"bg-green-100 dark:bg-green-900/30 p-4 rounded-lg",children:(0,s.jsx)("span",{className:"text-3xl",children:"\uD83D\uDCB0"})})]})})}),(0,s.jsx)(l.Zb,{className:"bg-white dark:bg-gray-800 border-2 border-blue-200 dark:border-blue-600 shadow-lg",children:(0,s.jsx)(l.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-bold text-gray-600 dark:text-gray-300",children:"Satisfa\xe7\xe3o M\xe9dia"}),(0,s.jsx)("p",{className:"text-3xl font-black text-blue-600 dark:text-blue-400",children:(t.reduce((e,a)=>e+parseFloat(a.avgSatisfaction),0)/(t.length||1)).toFixed(1)})]}),(0,s.jsx)("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-4 rounded-lg",children:(0,s.jsx)("span",{className:"text-3xl",children:"⭐"})})]})})})]}),(0,s.jsxs)(l.Zb,{children:[(0,s.jsx)(l.Ol,{children:(0,s.jsx)(l.ll,{children:"\uD83C\uDFC6 Top 5 Clientes (Por Score de Relacionamento)"})}),(0,s.jsx)(l.aY,{children:(0,s.jsx)("div",{className:"space-y-4",children:m.map((e,a)=>(0,s.jsxs)("div",{className:"p-4 rounded-lg ".concat(getPriorityColor(e.priority)," hover:shadow-md transition-shadow"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"text-2xl font-bold text-gray-600 dark:text-gray-400",children:["#",a+1]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:e.client.name}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.client.address.city," - ",e.client.address.state," • ",e.client.segment]})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("div",{className:"flex space-x-2 mb-2",children:[getClassificationBadge(e.classification),getRiskBadge(e.riskStatus)]}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Score: ",(0,s.jsxs)("span",{className:"font-bold",children:[e.relationshipScore,"/100"]})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:formatCurrency(e.totalValue)}),(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Total Compras"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:e.purchaseFrequency}),(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Frequ\xeancia"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-lg font-bold text-purple-600 dark:text-purple-400",children:formatCurrency(e.averageTicket)}),(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Ticket M\xe9dio"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:[e.daysSinceLastPurchase,"d"]}),(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"\xdaltima Compra"})]})]})]},e.client.id))})})]}),h.length>0&&(0,s.jsxs)(l.Zb,{className:"border-2 border-red-200 dark:border-red-600",children:[(0,s.jsx)(l.Ol,{children:(0,s.jsx)(l.ll,{className:"text-red-700 dark:text-red-300",children:"\uD83D\uDEA8 Clientes de Alto Risco - A\xe7\xe3o Necess\xe1ria"})}),(0,s.jsx)(l.aY,{children:(0,s.jsx)("div",{className:"space-y-4",children:h.map(e=>(0,s.jsxs)("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-700",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:e.client.name}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["\xdaltima compra h\xe1 ",e.daysSinceLastPurchase," dias"]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"text-lg font-bold text-red-600 dark:text-red-400 mb-1",children:formatCurrency(e.totalValue)}),(0,s.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total hist\xf3rico"})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,s.jsx)(i.z,{size:"sm",className:"bg-red-600 hover:bg-red-700",onClick:()=>{alert("A\xe7\xe3o de reten\xe7\xe3o iniciada para ".concat(e.client.name,"!"))},children:"\uD83D\uDCDE Contatar Urgente"}),(0,s.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>{alert("Oferta especial preparada para ".concat(e.client.name,"!"))},children:"\uD83C\uDF81 Oferta Especial"})]})]},e.client.id))})})]}),(0,s.jsxs)(l.Zb,{children:[(0,s.jsx)(l.Ol,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(l.ll,{children:"\uD83D\uDCCA Todos os Clientes"}),(0,s.jsx)("div",{children:(0,s.jsxs)("select",{value:d,onChange:e=>o(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,s.jsx)("option",{value:"all",children:"Todos os Segmentos"}),g.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})})]})}),(0,s.jsx)(l.aY,{children:(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:x.map(e=>(0,s.jsxs)("div",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:shadow-md transition-shadow bg-gray-50 dark:bg-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-bold text-gray-900 dark:text-white text-sm",children:e.client.name}),(0,s.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[e.client.address.city," - ",e.client.address.state]})]}),(0,s.jsx)("div",{className:"text-right",children:getClassificationBadge(e.classification)})]}),(0,s.jsxs)("div",{className:"space-y-2 text-xs",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Total:"}),(0,s.jsx)("span",{className:"font-bold text-gray-900 dark:text-white",children:formatCurrency(e.totalValue)})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Frequ\xeancia:"}),(0,s.jsxs)("span",{className:"font-bold text-gray-900 dark:text-white",children:[e.purchaseFrequency," compras"]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Score:"}),(0,s.jsxs)("span",{className:"font-bold text-gray-900 dark:text-white",children:[e.relationshipScore,"/100"]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Risco:"}),getRiskBadge(e.riskStatus)]})]})]},e.client.id))})})]})]})},components_SalesReport=()=>{var e,a,t;let[x,g]=(0,r.useState)([]),[m,h]=(0,r.useState)([]),[u,b]=(0,r.useState)("all"),[j,p]=(0,r.useState)("all"),[v,f]=(0,r.useState)("all"),[y,N]=(0,r.useState)(""),[D,k]=(0,r.useState)(null),[w,C]=(0,r.useState)({}),[S,B]=(0,r.useState)("sales"),[A,E]=(0,r.useState)(!1);(0,r.useEffect)(()=>{loadRealSalesData()},[]);let loadRealSalesData=async()=>{try{let e=await fetch("/api/sales-list"),a=await e.json(),t=await fetch("/api/animals-list"),s=await t.json();if(console.log("Vendas carregadas:",a.length),console.log("Animais carregados:",s.length),0===a.length&&s.length>0)g([]),h([]);else{let e=convertRealSalesToFormat(a);g(e),h(e)}}catch(e){console.error("Erro ao carregar dados reais:",e),loadMockData()}},loadMockData=()=>{g([]),h([])},convertRealSalesToFormat=e=>e.map((e,a)=>{var t,s,r,l,i;return{id:e.id,saleDate:e.dataVenda,client:{id:"CLI".concat(String(a+1).padStart(3,"0")),name:e.nomeComprador||"Cliente ".concat(a+1),cnpj:e.cnpjComprador||"00.000.000/0001-00",contact:e.contatoComprador||"N\xe3o informado",phone:e.telefoneComprador||"N\xe3o informado",email:e.emailComprador||"nao-informado@email.com",address:{street:"N\xe3o informado",city:e.cidadeComprador||"N\xe3o informado",state:e.estadoComprador||"SP",zipCode:"00000-000"},segment:"Cliente Real",clientSince:e.createdAt,totalPurchases:e.valorVenda,averageTicket:e.valorVenda,paymentTerms:"30 dias",creditLimit:5e5,lastPurchase:e.dataVenda},animals:[{id:(null===(t=e.animal)||void 0===t?void 0:t.brinco)||e.animalId,breed:(null===(s=e.animal)||void 0===s?void 0:s.raca)||"Nelore",weight:e.pesoVenda||450,age:24,gender:(null===(r=e.animal)||void 0===r?void 0:r.sexo)==="MACHO"?"M":"F",unitPrice:e.precoKg||280,totalPrice:e.valorVenda,category:(null===(l=e.animal)||void 0===l?void 0:l.sexo)==="MACHO"?"Terminado":"Matriz",name:null===(i=e.animal)||void 0===i?void 0:i.nome}],totalValue:e.valorVenda,totalWeight:e.pesoVenda||450,averagePrice:e.precoKg||280,paymentStatus:"Pendente",paymentDate:null,deliveryDate:e.dataVenda,transportCompany:"N\xe3o informado",notes:e.observacoes||"Venda real do sistema",satisfaction:"Bom",followUpDate:new Date(Date.now()+2592e6).toISOString().split("T")[0],followUpStatus:"Pendente"}});(0,r.useEffect)(()=>{let e=x;if("all"!==u){let a=new Date,t=new Date(a.getTime()-864e5*({"7d":7,"30d":30,"90d":90,"180d":180,"365d":365})[u]);e=e.filter(e=>new Date(e.saleDate)>=t)}"all"!==j&&(e=e.filter(e=>e.client.address.state===j)),"all"!==v&&(e=e.filter(e=>e.client.id===v)),y&&(e=e.filter(e=>e.client.name.toLowerCase().includes(y.toLowerCase())||e.client.contact.toLowerCase().includes(y.toLowerCase())||e.client.cnpj.includes(y))),h(e)},[x,u,j,v,y]);let formatCurrency=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),formatDate=e=>new Date(e).toLocaleDateString("pt-BR"),getPaymentStatusBadge=e=>{let a={Pago:(0,s.jsx)(c.C,{className:"bg-green-600 text-white dark:bg-green-500 dark:text-white",children:"✅ Pago"}),Pendente:(0,s.jsx)(c.C,{className:"bg-yellow-600 text-white dark:bg-yellow-500 dark:text-white",children:"⏳ Pendente"}),Atrasado:(0,s.jsx)(c.C,{className:"bg-red-600 text-white dark:bg-red-500 dark:text-white",children:"\uD83D\uDEA8 Atrasado"})};return a[e]||a.Pendente},getSatisfactionBadge=e=>{let a={Excelente:(0,s.jsx)(c.C,{className:"bg-green-600 text-white dark:bg-green-500 dark:text-white",children:"\uD83D\uDE0D Excelente"}),"Muito Bom":(0,s.jsx)(c.C,{className:"bg-blue-600 text-white dark:bg-blue-500 dark:text-white",children:"\uD83D\uDE0A Muito Bom"}),Bom:(0,s.jsx)(c.C,{className:"bg-yellow-600 text-white dark:bg-yellow-500 dark:text-white",children:"\uD83D\uDE42 Bom"}),Regular:(0,s.jsx)(c.C,{className:"bg-orange-600 text-white dark:bg-orange-500 dark:text-white",children:"\uD83D\uDE10 Regular"}),Ruim:(0,s.jsx)(c.C,{className:"bg-red-600 text-white dark:bg-red-500 dark:text-white",children:"\uD83D\uDE1E Ruim"})};return a[e]||a.Bom},getFollowUpStatusBadge=e=>{let a={Realizado:(0,s.jsx)(c.C,{className:"bg-green-600 text-white dark:bg-green-500 dark:text-white",children:"✅ Realizado"}),Pendente:(0,s.jsx)(c.C,{className:"bg-yellow-600 text-white dark:bg-yellow-500 dark:text-white",children:"\uD83D\uDCC5 Pendente"}),Agendado:(0,s.jsx)(c.C,{className:"bg-blue-600 text-white dark:bg-blue-500 dark:text-white",children:"\uD83D\uDCDE Agendado"})};return a[e]||a.Pendente},R=m.reduce((e,a)=>e+a.totalValue,0),P=m.reduce((e,a)=>e+a.animals.length,0),T=m.length>0?R/m.length:0,V=[...new Set(m.map(e=>e.client.id))],z=[...new Set(x.map(e=>e.client.address.state))],handleFollowUpNote=(e,a)=>{C(t=>({...t,[e]:a}))};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(l.Zb,{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white",children:(0,s.jsx)(l.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"\uD83D\uDCCA Relat\xf3rio de Vendas por Cliente"}),(0,s.jsx)("p",{className:"text-blue-100 text-lg",children:"Sistema completo para an\xe1lise e p\xf3s-venda"})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"text-4xl mb-2",children:"\uD83C\uDFAF"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(i.z,{variant:"sales"===S?"default":"outline",size:"sm",onClick:()=>B("sales"),className:"sales"===S?"bg-white text-blue-600":"bg-white/20 text-white border-white/30",children:"\uD83D\uDCCB Vendas"}),(0,s.jsx)(i.z,{variant:"analysis"===S?"default":"outline",size:"sm",onClick:()=>B("analysis"),className:"analysis"===S?"bg-white text-blue-600":"bg-white/20 text-white border-white/30",children:"\uD83D\uDC65 An\xe1lise Clientes"}),(0,s.jsx)(i.z,{variant:"bi"===S?"default":"outline",size:"sm",onClick:()=>B("bi"),className:"bi"===S?"bg-white text-blue-600":"bg-white/20 text-white border-white/30",children:"\uD83D\uDCCA BI Analytics"})]})]})]})})}),"analysis"===S?(0,s.jsx)(components_ClientAnalysis,{salesData:x}):"bi"===S?(0,s.jsx)(()=>{let[e,a]=(0,r.useState)([]),[t,o]=(0,r.useState)("30"),[x,g]=(0,r.useState)(""),[h,u]=(0,r.useState)(!1);r.useEffect(()=>{loadBIData()},[]);let loadBIData=async()=>{try{let e=await fetch("/api/sales-data"),t=await e.json();if(t.hasRealSales)a(t.sales);else{let e=m.map(e=>({date:e.saleDate,vendas:e.animals.length,valor:e.totalValue,categoria:e.client.segment,regiao:e.client.address.state,animal:e.animals[0]}));a(e)}}catch(t){console.error("Erro ao carregar dados BI:",t);let e=m.map(e=>({date:e.saleDate,vendas:e.animals.length,valor:e.totalValue,categoria:e.client.segment,regiao:e.client.address.state}));a(e)}},handleSendWhatsApp=async e=>{if(!x){u(!0);return}try{console.log("Enviando relat\xf3rio BI via WhatsApp:",{to:x,message:e.substring(0,100)+"..."}),alert("Relat\xf3rio BI enviado via WhatsApp com sucesso!"),u(!1)}catch(e){console.error("Erro ao enviar WhatsApp:",e),alert("Erro ao enviar relat\xf3rio via WhatsApp")}},generateBIReport=()=>{let a=e.reduce((e,a)=>e+a.vendas,0),s=e.reduce((e,a)=>e+a.valor,0),r=a>0?s/a:0,l={};e.forEach(e=>{l[e.categoria]||(l[e.categoria]={vendas:0,valor:0}),l[e.categoria].vendas+=e.vendas,l[e.categoria].valor+=e.valor});let i=Object.entries(l).map(e=>{let[a,t]=e;return{categoria:a,vendas:t.vendas,valor:t.valor,participacao:(t.valor/s*100).toFixed(1)}}).sort((e,a)=>a.valor-e.valor),n="\n\uD83D\uDC04 *RELAT\xd3RIO BI - VENDAS DE GADO*\n\uD83D\uDCC5 Per\xedodo: \xdaltimos ".concat(t," dias\n\n\uD83D\uDCCA *RESUMO EXECUTIVO*\n• Total de Vendas: ").concat(a," cabe\xe7as\n• Receita Total: R$ ").concat((s/1e3).toFixed(0),"k\n• Ticket M\xe9dio: R$ ").concat((r/1e3).toFixed(1),"k\n• Vendas/Dia: ").concat(Math.round(a/parseInt(t))," cabe\xe7as\n\n\uD83D\uDCC8 *AN\xc1LISE POR SEGMENTO*\n").concat(i.map(e=>"• ".concat(e.categoria,": ").concat(e.vendas," vendas (").concat(e.participacao,"%)")).join("\n"),"\n\n\uD83D\uDCA1 *INSIGHTS*\n• ").concat(i.length>0?i[0].categoria:"N/A"," lidera com ").concat(i.length>0?i[0].participacao:"0","% das vendas\n• Performance ").concat(a>50?"excelente":a>20?"boa":"regular"," no per\xedodo\n• Ticket m\xe9dio ").concat(r>1e5?"alto":r>5e4?"m\xe9dio":"baixo","\n\n---\n\uD83E\uDD16 Relat\xf3rio gerado automaticamente pelo BeefSync\n\uD83D\uDCF1 Sistema de Gest\xe3o de Leil\xe3o\n      ").trim();return n};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(l.Zb,{children:[(0,s.jsx)(l.Ol,{children:(0,s.jsxs)(l.ll,{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("span",{children:"\uD83D\uDCCA Business Intelligence - An\xe1lise de Vendas"}),(0,s.jsx)(c.C,{className:e.length>0&&e[0].animal?"bg-green-600":"bg-yellow-600",children:e.length>0&&e[0].animal?"✅ Dados Reais":"⚠️ Demo"})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(i.z,{onClick:loadBIData,size:"sm",variant:"outline",children:"\uD83D\uDD04 Atualizar"}),(0,s.jsxs)(d.Ph,{value:t,onValueChange:o,children:[(0,s.jsx)("option",{value:"7",children:"\xdaltimos 7 dias"}),(0,s.jsx)("option",{value:"30",children:"\xdaltimos 30 dias"}),(0,s.jsx)("option",{value:"90",children:"\xdaltimos 90 dias"}),(0,s.jsx)("option",{value:"365",children:"\xdaltimo ano"})]}),(0,s.jsx)(i.z,{onClick:()=>u(!0),className:"bg-green-600 hover:bg-green-700",children:"\uD83D\uDCF1 Enviar WhatsApp"})]})]})}),(0,s.jsx)(l.aY,{children:(0,s.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.length>0&&e[0].animal?"\uD83D\uDCCA Analisando ".concat(e.length," vendas reais com animais importados"):"⚠️ Usando dados de demonstra\xe7\xe3o. Importe animais e registre vendas para ver dados reais."})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)(l.Zb,{className:"bg-gradient-to-r from-green-500 to-green-600 text-white",children:(0,s.jsx)(l.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-3xl font-bold",children:e.reduce((e,a)=>e+a.vendas,0)}),(0,s.jsx)("div",{className:"text-green-100",children:"Total de Vendas"})]})})}),(0,s.jsx)(l.Zb,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:(0,s.jsx)(l.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"text-3xl font-bold",children:["R$ ",(e.reduce((e,a)=>e+a.valor,0)/1e3).toFixed(0),"k"]}),(0,s.jsx)("div",{className:"text-blue-100",children:"Receita Total"})]})})}),(0,s.jsx)(l.Zb,{className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:(0,s.jsx)(l.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"text-3xl font-bold",children:["R$ ",e.length>0?(e.reduce((e,a)=>e+a.valor,0)/e.reduce((e,a)=>e+a.vendas,0)/1e3).toFixed(1):0,"k"]}),(0,s.jsx)("div",{className:"text-purple-100",children:"Ticket M\xe9dio"})]})})}),(0,s.jsx)(l.Zb,{className:"bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:(0,s.jsx)(l.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-3xl font-bold",children:Math.round(e.reduce((e,a)=>e+a.vendas,0)/Math.max(parseInt(t),1))}),(0,s.jsx)("div",{className:"text-orange-100",children:"Vendas/Dia"})]})})})]}),(0,s.jsxs)(l.Zb,{children:[(0,s.jsx)(l.Ol,{children:(0,s.jsx)(l.ll,{children:"\uD83D\uDCC8 Evolu\xe7\xe3o de Vendas por Per\xedodo"})}),(0,s.jsx)(l.aY,{children:(0,s.jsx)("div",{className:"h-64 flex items-end justify-between bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:e.slice(-10).map((a,t)=>{let r=Math.max(...e.map(e=>e.valor)),l=a.valor/r*200;return(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("div",{className:"bg-gradient-to-t from-blue-600 to-purple-600 rounded-t w-8 transition-all duration-1000",style:{height:"".concat(l,"px")},title:"".concat(new Date(a.date).toLocaleDateString("pt-BR"),": R$ ").concat(a.valor.toLocaleString("pt-BR"))}),(0,s.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-2 transform -rotate-45",children:new Date(a.date).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})})]},t)})})})]}),e.length>0&&e[0].animal&&(0,s.jsxs)(l.Zb,{children:[(0,s.jsx)(l.Ol,{children:(0,s.jsx)(l.ll,{children:"\uD83D\uDC04 Animais Inclu\xeddos na An\xe1lise"})}),(0,s.jsxs)(l.aY,{children:[(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:e.slice(0,6).map((e,a)=>(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-lg border",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-bold text-gray-900 dark:text-white",children:e.animal.id}),(0,s.jsx)(c.C,{className:"ml-2 bg-blue-600 text-white",children:e.animal.raca})]}),(0,s.jsxs)("span",{className:"text-lg font-bold text-green-600",children:["R$ ",(e.valor/1e3).toFixed(0),"k"]})]}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,s.jsx)("strong",{children:"Nome:"})," ",e.animal.nome||"N\xe3o informado",(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Sexo:"})," ",e.animal.sexo,(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Data:"})," ",new Date(e.date).toLocaleDateString("pt-BR")]})]},a))}),e.length>6&&(0,s.jsx)("div",{className:"text-center mt-4",children:(0,s.jsxs)(c.C,{variant:"outline",children:["+",e.length-6," animais adicionais na an\xe1lise"]})})]})]}),(0,s.jsxs)(l.Zb,{children:[(0,s.jsx)(l.Ol,{children:(0,s.jsx)(l.ll,{children:"\uD83C\uDFAF An\xe1lise por Segmento de Cliente"})}),(0,s.jsx)(l.aY,{children:(0,s.jsx)("div",{className:"space-y-4",children:(()=>{let a={};e.forEach(e=>{a[e.categoria]||(a[e.categoria]={vendas:0,valor:0}),a[e.categoria].vendas+=e.vendas,a[e.categoria].valor+=e.valor});let t=Object.values(a).reduce((e,a)=>e+a.valor,0);return Object.entries(a).sort((e,a)=>{let[,t]=e,[,s]=a;return s.valor-t.valor}).map(e=>{let[a,r]=e,l=t>0?r.valor/t*100:0;return(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-4 h-4 bg-gradient-to-r from-blue-500 to-purple-500 rounded"}),(0,s.jsx)("span",{className:"font-medium",children:a})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"font-bold text-green-600",children:formatCurrency(r.valor)}),(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:[r.vendas," vendas (",l.toFixed(1),"%)"]})]})]},a)})})()})})]}),(0,s.jsxs)(l.Zb,{children:[(0,s.jsx)(l.Ol,{children:(0,s.jsx)(l.ll,{children:"\uD83D\uDCCB Preview do Relat\xf3rio BI"})}),(0,s.jsxs)(l.aY,{children:[(0,s.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:(0,s.jsx)("pre",{className:"text-sm whitespace-pre-wrap text-gray-700 dark:text-gray-300",children:generateBIReport()})}),(0,s.jsxs)("div",{className:"mt-4 flex space-x-2",children:[(0,s.jsx)(i.z,{onClick:()=>u(!0),className:"bg-green-600 hover:bg-green-700",children:"\uD83D\uDCF1 Enviar via WhatsApp"}),(0,s.jsx)(i.z,{onClick:()=>{let e=document.createElement("a"),a=new Blob([generateBIReport()],{type:"text/plain"});e.href=URL.createObjectURL(a),e.download="relatorio-bi-".concat(new Date().toISOString().split("T")[0],".txt"),document.body.appendChild(e),e.click(),document.body.removeChild(e)},variant:"outline",children:"\uD83D\uDCE5 Download TXT"})]})]})]}),h&&(0,s.jsx)(()=>(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 max-w-md w-full mx-4",children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Enviar Relat\xf3rio BI via WhatsApp"}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"N\xfamero do WhatsApp"}),(0,s.jsx)(n.I,{type:"text",value:x,onChange:e=>g(e.target.value),placeholder:"+55 11 99999-9999"})]}),(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)(i.z,{onClick:()=>u(!1),variant:"outline",className:"flex-1",children:"Cancelar"}),(0,s.jsx)(i.z,{onClick:()=>{x&&handleSendWhatsApp(generateBIReport())},className:"flex-1 bg-green-600 hover:bg-green-700",children:"\uD83D\uDCF1 Enviar"})]})]})}),{})]})},{}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(l.Zb,{children:[(0,s.jsx)(l.Ol,{children:(0,s.jsx)(l.ll,{children:"\uD83D\uDD0D Filtros e Busca"})}),(0,s.jsx)(l.aY,{children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Per\xedodo"}),(0,s.jsxs)(d.Ph,{value:u,onValueChange:b,children:[(0,s.jsx)("option",{value:"all",children:"Todos os per\xedodos"}),(0,s.jsx)("option",{value:"7d",children:"\xdaltimos 7 dias"}),(0,s.jsx)("option",{value:"30d",children:"\xdaltimos 30 dias"}),(0,s.jsx)("option",{value:"90d",children:"\xdaltimos 90 dias"}),(0,s.jsx)("option",{value:"180d",children:"\xdaltimos 6 meses"}),(0,s.jsx)("option",{value:"365d",children:"\xdaltimo ano"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Estado"}),(0,s.jsxs)(d.Ph,{value:j,onValueChange:p,children:[(0,s.jsx)("option",{value:"all",children:"Todos os estados"}),z.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Cliente"}),(0,s.jsxs)(d.Ph,{value:v,onValueChange:f,children:[(0,s.jsx)("option",{value:"all",children:"Todos os clientes"}),V.map(e=>{var a;let t=null===(a=x.find(a=>a.client.id===e))||void 0===a?void 0:a.client;return(0,s.jsx)("option",{value:e,children:null==t?void 0:t.name},e)})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Buscar"}),(0,s.jsx)(n.I,{placeholder:"Nome, CNPJ ou contato...",value:y,onChange:e=>N(e.target.value)})]}),(0,s.jsxs)("div",{className:"flex items-end space-x-2",children:[(0,s.jsx)(i.z,{onClick:loadRealSalesData,className:"bg-blue-600 hover:bg-blue-700",children:"\uD83D\uDD04 Recarregar Dados"}),(0,s.jsx)(i.z,{onClick:()=>{let e=m.map(e=>[formatDate(e.saleDate),e.client.name,e.client.cnpj,e.client.contact,e.client.phone,e.client.email,e.client.address.city,e.client.address.state,e.client.segment,e.totalValue,e.animals.length,e.totalWeight,e.averagePrice.toFixed(2),e.paymentStatus,e.satisfaction,e.followUpStatus,e.notes]),a=[["Data Venda","Cliente","CNPJ","Contato","Telefone","Email","Cidade","Estado","Segmento","Valor Total","Qtd Animais","Peso Total","Pre\xe7o M\xe9dio","Status Pagamento","Satisfa\xe7\xe3o","Follow-up","Observa\xe7\xf5es"],...e].map(e=>e.map(e=>'"'.concat(e,'"')).join(",")).join("\n"),t=new Blob([a],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");s.href=URL.createObjectURL(t),s.download="relatorio_vendas_".concat(new Date().toISOString().split("T")[0],".csv"),s.click()},className:"bg-green-600 hover:bg-green-700",children:"\uD83D\uDCE5 Exportar CSV"})]})]})})]}),(0,s.jsx)(l.Zb,{className:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-600",children:(0,s.jsx)(l.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-blue-900 dark:text-blue-100 mb-2",children:"\uD83D\uDCCA Status dos Dados"}),(0,s.jsx)("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:x.length>0&&(null===(e=x[0].notes)||void 0===e?void 0:e.includes("animal real"))?"✅ Dados baseados em ".concat(x.reduce((e,a)=>e+a.animals.length,0)," animais reais importados"):x.length>0&&(null===(t=x[0].client)||void 0===t?void 0:null===(a=t.name)||void 0===a?void 0:a.includes("Cliente Real"))?"✅ ".concat(x.length," vendas reais carregadas do sistema"):"⚠️ Usando dados de demonstra\xe7\xe3o (".concat(x.length," vendas)")})]}),(0,s.jsx)(i.z,{onClick:loadRealSalesData,size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:"\uD83D\uDD04 Atualizar"})]})})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,s.jsx)(l.Zb,{className:"bg-white dark:bg-gray-800 border-2 border-green-200 dark:border-green-600 shadow-lg",children:(0,s.jsx)(l.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-bold text-gray-600 dark:text-gray-300",children:"Total Vendas"}),(0,s.jsx)("p",{className:"text-3xl font-black text-green-600 dark:text-green-400",children:formatCurrency(R)})]}),(0,s.jsx)("div",{className:"bg-green-100 dark:bg-green-900/30 p-4 rounded-lg",children:(0,s.jsx)("span",{className:"text-3xl",children:"\uD83D\uDCB0"})})]})})}),(0,s.jsx)(l.Zb,{className:"bg-white dark:bg-gray-800 border-2 border-blue-200 dark:border-blue-600 shadow-lg",children:(0,s.jsx)(l.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-bold text-gray-600 dark:text-gray-300",children:"Total Animais"}),(0,s.jsx)("p",{className:"text-3xl font-black text-blue-600 dark:text-blue-400",children:P})]}),(0,s.jsx)("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-4 rounded-lg",children:(0,s.jsx)("span",{className:"text-3xl",children:"\uD83D\uDC04"})})]})})}),(0,s.jsx)(l.Zb,{className:"bg-white dark:bg-gray-800 border-2 border-purple-200 dark:border-purple-600 shadow-lg",children:(0,s.jsx)(l.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-bold text-gray-600 dark:text-gray-300",children:"Ticket M\xe9dio"}),(0,s.jsx)("p",{className:"text-3xl font-black text-purple-600 dark:text-purple-400",children:formatCurrency(T)})]}),(0,s.jsx)("div",{className:"bg-purple-100 dark:bg-purple-900/30 p-4 rounded-lg",children:(0,s.jsx)("span",{className:"text-3xl",children:"\uD83D\uDCCA"})})]})})}),(0,s.jsx)(l.Zb,{className:"bg-white dark:bg-gray-800 border-2 border-orange-200 dark:border-orange-600 shadow-lg",children:(0,s.jsx)(l.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-bold text-gray-600 dark:text-gray-300",children:"Clientes \xdanicos"}),(0,s.jsx)("p",{className:"text-3xl font-black text-orange-600 dark:text-orange-400",children:V.length})]}),(0,s.jsx)("div",{className:"bg-orange-100 dark:bg-orange-900/30 p-4 rounded-lg",children:(0,s.jsx)("span",{className:"text-3xl",children:"\uD83D\uDC65"})})]})})})]}),(0,s.jsxs)(l.Zb,{children:[(0,s.jsx)(l.Ol,{children:(0,s.jsxs)(l.ll,{children:["\uD83D\uDCCB Vendas Detalhadas (",m.length,")"]})}),(0,s.jsx)(l.aY,{children:(0,s.jsx)("div",{className:"space-y-6",children:m.map(e=>(0,s.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-6 hover:shadow-lg transition-shadow bg-gray-50 dark:bg-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-1",children:e.client.name}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Venda #",e.id," • ",formatDate(e.saleDate)]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400 mb-1",children:formatCurrency(e.totalValue)}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[getPaymentStatusBadge(e.paymentStatus),getSatisfactionBadge(e.satisfaction)]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4 p-4 bg-white dark:bg-gray-800 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"\uD83D\uDCDE Contato"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,s.jsx)("strong",{children:"Respons\xe1vel:"})," ",e.client.contact,(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Telefone:"})," ",e.client.phone,(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Email:"})," ",e.client.email]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"\uD83D\uDCCD Localiza\xe7\xe3o"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.client.address.city," -"," ",e.client.address.state,(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"CEP:"})," ",e.client.address.zipCode,(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Segmento:"})," ",e.client.segment]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"\uD83D\uDCBC Hist\xf3rico"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,s.jsx)("strong",{children:"Cliente desde:"})," ",formatDate(e.client.clientSince),(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Total compras:"})," ",formatCurrency(e.client.totalPurchases),(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Ticket m\xe9dio:"})," ",formatCurrency(e.client.averageTicket)]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"\uD83D\uDCB3 Financeiro"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,s.jsx)("strong",{children:"Prazo:"})," ",e.client.paymentTerms,(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Limite:"})," ",formatCurrency(e.client.creditLimit),(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"CNPJ:"})," ",e.client.cnpj]})]})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("h4",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:["\uD83D\uDC04 Animais Vendidos (",e.animals.length,")"]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:e.animals.map(e=>(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-lg border border-gray-200 dark:border-gray-600",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-bold text-gray-900 dark:text-white",children:e.id}),(0,s.jsx)(c.C,{className:"ml-2 bg-blue-600 text-white dark:bg-blue-500 dark:text-white",children:e.category})]}),(0,s.jsx)("span",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:formatCurrency(e.totalPrice)})]}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,s.jsx)("strong",{children:"Ra\xe7a:"})," ",e.breed," •"," ",(0,s.jsx)("strong",{children:"Peso:"})," ",e.weight,"kg",(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Idade:"})," ",e.age," meses •"," ",(0,s.jsx)("strong",{children:"Sexo:"})," ",e.gender,(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Pre\xe7o/kg:"})," R$"," ",e.unitPrice.toFixed(2)]})]},e.id))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:[e.totalWeight,"kg"]}),(0,s.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Peso Total"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:["R$ ",e.averagePrice.toFixed(2)]}),(0,s.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Pre\xe7o M\xe9dio/kg"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:e.animals.length}),(0,s.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Animais"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4 p-4 bg-gray-100 dark:bg-gray-600 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"\uD83D\uDE9B Log\xedstica"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,s.jsx)("strong",{children:"Transportadora:"})," ",e.transportCompany,(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Data Entrega:"})," ",formatDate(e.deliveryDate),(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Status:"})," Entregue"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"\uD83D\uDCB0 Pagamento"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,s.jsx)("strong",{children:"Status:"})," ",e.paymentStatus,(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Data Pagamento:"})," ",e.paymentDate?formatDate(e.paymentDate):"Pendente",(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Prazo:"})," ",e.client.paymentTerms]})]})]}),(0,s.jsxs)("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white",children:"\uD83D\uDCDE P\xf3s-Venda"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[getFollowUpStatusBadge(e.followUpStatus),(0,s.jsxs)(c.C,{className:"bg-gray-600 text-white dark:bg-gray-500 dark:text-white",children:["\uD83D\uDCC5 ",formatDate(e.followUpDate)]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:(0,s.jsx)("strong",{children:"Observa\xe7\xf5es da venda:"})}),(0,s.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 p-2 rounded",children:e.notes})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:(0,s.jsx)("strong",{children:"Notas de follow-up:"})}),(0,s.jsx)(o.g,{placeholder:"Adicionar notas do follow-up...",value:w[e.id]||"",onChange:a=>handleFollowUpNote(e.id,a.target.value),rows:3,className:"text-sm"})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,s.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>window.open("tel:".concat(e.client.phone)),children:"\uD83D\uDCDE Ligar"}),(0,s.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>window.open("mailto:".concat(e.client.email)),children:"\uD83D\uDCE7 Email"}),(0,s.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>window.open("https://wa.me/".concat(e.client.phone.replace(/\D/g,""))),children:"\uD83D\uDCAC WhatsApp"}),(0,s.jsx)(i.z,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>{alert("Follow-up agendado para ".concat(e.client.name,"!"))},children:"✅ Marcar Follow-up"})]})]})]},e.id))})})]})]})]})};function VendasPage(){return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-6",children:(0,s.jsx)(components_SalesReport,{})})}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=7624)}),_N_E=e.O()}]);