(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{1118:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return t(2415)}])},9630:function(e,a,t){"use strict";t.d(a,{qD:function(){return useApp},wI:function(){return AppProvider}});var r=t(5893),s=t(7294);let o={user:null,animals:[],materials:[],sales:[],processes:[],notifications:[],loading:!1,error:null,theme:"light",filters:{dateRange:"30d",category:"all",status:"all"},stats:{totalAnimals:0,totalValue:0,monthlyProfit:0,pendingTasks:0}},l={SET_LOADING:"SET_LOADING",SET_ERROR:"SET_ERROR",SET_USER:"SET_USER",SET_ANIMALS:"SET_ANIMALS",ADD_ANIMAL:"ADD_ANIMAL",UPDATE_ANIMAL:"UPDATE_ANIMAL",DELETE_ANIMAL:"DELETE_ANIMAL",SET_MATERIALS:"SET_MATERIALS",ADD_MATERIAL:"ADD_MATERIAL",UPDATE_MATERIAL:"UPDATE_MATERIAL",DELETE_MATERIAL:"DELETE_MATERIAL",SET_SALES:"SET_SALES",ADD_SALE:"ADD_SALE",SET_PROCESSES:"SET_PROCESSES",ADD_PROCESS:"ADD_PROCESS",UPDATE_PROCESS:"UPDATE_PROCESS",DELETE_PROCESS:"DELETE_PROCESS",ADD_NOTIFICATION:"ADD_NOTIFICATION",MARK_NOTIFICATION_READ:"MARK_NOTIFICATION_READ",SET_FILTERS:"SET_FILTERS",UPDATE_STATS:"UPDATE_STATS",TOGGLE_THEME:"TOGGLE_THEME"};function appReducer(e,a){switch(a.type){case l.SET_LOADING:return{...e,loading:a.payload};case l.SET_ERROR:return{...e,error:a.payload,loading:!1};case l.SET_USER:return{...e,user:a.payload};case l.SET_ANIMALS:return{...e,animals:a.payload};case l.ADD_ANIMAL:return{...e,animals:[...e.animals,a.payload]};case l.UPDATE_ANIMAL:return{...e,animals:e.animals.map(e=>e.id===a.payload.id?a.payload:e)};case l.DELETE_ANIMAL:return{...e,animals:e.animals.filter(e=>e.id!==a.payload)};case l.SET_MATERIALS:return{...e,materials:a.payload};case l.ADD_MATERIAL:return{...e,materials:[...e.materials,a.payload]};case l.UPDATE_MATERIAL:return{...e,materials:e.materials.map(e=>e.id===a.payload.id?a.payload:e)};case l.DELETE_MATERIAL:return{...e,materials:e.materials.filter(e=>e.id!==a.payload)};case l.SET_SALES:return{...e,sales:a.payload};case l.ADD_SALE:return{...e,sales:[...e.sales,a.payload]};case l.SET_PROCESSES:return{...e,processes:a.payload};case l.ADD_PROCESS:return{...e,processes:[...e.processes,a.payload]};case l.UPDATE_PROCESS:return{...e,processes:e.processes.map(e=>e.id===a.payload.id?a.payload:e)};case l.DELETE_PROCESS:return{...e,processes:e.processes.filter(e=>e.id!==a.payload)};case l.ADD_NOTIFICATION:return{...e,notifications:[a.payload,...e.notifications]};case l.MARK_NOTIFICATION_READ:return{...e,notifications:e.notifications.map(e=>e.id===a.payload?{...e,read:!0}:e)};case l.SET_FILTERS:return{...e,filters:{...e.filters,...a.payload}};case l.UPDATE_STATS:return{...e,stats:{...e.stats,...a.payload}};case l.TOGGLE_THEME:let t="light"===e.theme?"dark":"light";{localStorage.setItem("theme",t);let e=document.documentElement;"dark"===t?e.classList.add("dark"):e.classList.remove("dark"),e.style.colorScheme=t}return{...e,theme:t};case"SET_THEME":return"dark"===a.payload?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),{...e,theme:a.payload};default:return e}}let n=(0,s.createContext)();function AppProvider(e){let{children:a}=e,[t,i]=(0,s.useReducer)(appReducer,o);(0,s.useEffect)(()=>{let e=localStorage.getItem("theme");e&&e!==t.theme&&i({type:"SET_THEME",payload:e})},[]),(0,s.useEffect)(()=>{"dark"===t.theme?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[t.theme]),(0,s.useEffect)(()=>{loadInitialData()},[]),(0,s.useEffect)(()=>{calculateStats()},[t.animals,t.materials,t.sales]);let loadInitialData=async()=>{i({type:l.SET_LOADING,payload:!0});try{let e=await fetch("/api/animals-list"),a=e.ok?await e.json():[],t=await fetch("/api/sales-list"),r=t.ok?await t.json():[];i({type:l.SET_ANIMALS,payload:a}),i({type:l.SET_MATERIALS,payload:[]}),i({type:l.SET_SALES,payload:r})}catch(e){i({type:l.SET_ERROR,payload:e.message})}finally{i({type:l.SET_LOADING,payload:!1})}},calculateStats=()=>{let e=t.animals.length,a=t.animals.reduce((e,a)=>e+(a.value||0),0),r=t.sales.filter(e=>{let a=new Date(e.date),t=new Date;return a.getMonth()===t.getMonth()&&a.getFullYear()===t.getFullYear()}).reduce((e,a)=>e+a.totalValue,0),s=t.materials.filter(e=>e.quantity<=e.minStock).length;i({type:l.UPDATE_STATS,payload:{totalAnimals:e,totalValue:a,monthlyProfit:r,pendingTasks:s}})};return(0,r.jsx)(n.Provider,{value:{state:t,actions:{setLoading:e=>i({type:l.SET_LOADING,payload:e}),setError:e=>i({type:l.SET_ERROR,payload:e}),setUser:e=>i({type:l.SET_USER,payload:e}),addAnimal:e=>i({type:l.ADD_ANIMAL,payload:e}),updateAnimal:e=>i({type:l.UPDATE_ANIMAL,payload:e}),deleteAnimal:e=>i({type:l.DELETE_ANIMAL,payload:e}),addMaterial:e=>i({type:l.ADD_MATERIAL,payload:e}),updateMaterial:e=>i({type:l.UPDATE_MATERIAL,payload:e}),deleteMaterial:e=>i({type:l.DELETE_MATERIAL,payload:e}),addSale:e=>i({type:l.ADD_SALE,payload:e}),addProcess:e=>i({type:l.ADD_PROCESS,payload:e}),updateProcess:e=>i({type:l.UPDATE_PROCESS,payload:e}),deleteProcess:e=>i({type:l.DELETE_PROCESS,payload:e}),addNotification:e=>i({type:l.ADD_NOTIFICATION,payload:e}),markNotificationRead:e=>i({type:l.MARK_NOTIFICATION_READ,payload:e}),setFilters:e=>i({type:l.SET_FILTERS,payload:e}),toggleTheme:()=>i({type:l.TOGGLE_THEME})}},children:a})}function useApp(){let e=(0,s.useContext)(n);if(!e)throw Error("useApp deve ser usado dentro de AppProvider");return e}},7016:function(e,a,t){"use strict";t.d(a,{Ho:function(){return AuthProvider},aC:function(){return useAuth}});var r=t(5893),s=t(7294);let o=(0,s.createContext)(),useAuth=()=>{let e=(0,s.useContext)(o);if(!e)throw Error("useAuth deve ser usado dentro de AuthProvider");return e},AuthProvider=e=>{let{children:a}=e,[t,l]=(0,s.useState)(null),[n,i]=(0,s.useState)(!0),d={zeca:{name:"Zeca",role:"developer",permissions:["read","write","delete","admin","manage_users"],description:"Desenvolvedor - Acesso completo"},bento:{name:"Bento",role:"consultant",permissions:["read"],description:"Consultor - Apenas visualiza\xe7\xe3o"},nilson:{name:"Nilson",role:"consultant",permissions:["read"],description:"Consultor - Apenas visualiza\xe7\xe3o"},mauricio:{name:"Maur\xedcio",role:"consultant",permissions:["read"],description:"Consultor - Apenas visualiza\xe7\xe3o"}};(0,s.useEffect)(()=>{let e=localStorage.getItem("beef-sync-user");e&&l(JSON.parse(e)),i(!1)},[]);let login=async(e,a)=>{if(i(!0),await new Promise(e=>setTimeout(e,1e3)),!d[e])return{success:!1,error:"Usu\xe1rio n\xe3o encontrado"};{let a={username:e,name:d[e].name,role:d[e].role,permissions:d[e].permissions};return l(a),localStorage.setItem("beef-sync-user",JSON.stringify(a)),{success:!0}}};return(0,r.jsx)(o.Provider,{value:{user:t,loading:n,login,logout:()=>{l(null),localStorage.removeItem("beef-sync-user")},checkPermission:e=>{if(!t)return!1;let a=d[t.username]||d.bento;return a.permissions.includes(e)},getUserRole:()=>t?d[t.username]||d.bento:null,userRoles:d},children:a})}},2415:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return _app}});var r=t(5893);t(415);var s=t(7294);let o=(0,s.createContext)(),ThemeProvider=e=>{let{children:a}=e,[t,l]=(0,s.useState)("light");return(0,s.useEffect)(()=>{let e=localStorage.getItem("theme");if(e)l(e);else{let e=window.matchMedia("(prefers-color-scheme: dark)").matches;l(e?"dark":"light")}},[]),(0,s.useEffect)(()=>{"dark"===t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("theme",t)},[t]),(0,r.jsx)(o.Provider,{value:{theme:t,setTheme:l,toggleTheme:()=>{l(e=>"light"===e?"dark":"light")},isDark:"dark"===t},children:a})};var l=t(7016);let n=(0,s.createContext)(),ToastProvider=e=>{let{children:a}=e,[t,o]=(0,s.useState)([]),addToast=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,r=Date.now(),s={id:r,message:e,type:a,duration:t};return o(e=>[...e,s]),t>0&&setTimeout(()=>{removeToast(r)},t),r},removeToast=e=>{o(a=>a.filter(a=>a.id!==e))};return(0,r.jsxs)(n.Provider,{value:{toasts:t,addToast,removeToast,success:(e,a)=>addToast(e,"success",a),error:(e,a)=>addToast(e,"error",a),warning:(e,a)=>addToast(e,"warning",a),info:(e,a)=>addToast(e,"info",a)},children:[a,(0,r.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:t.map(e=>(0,r.jsx)("div",{className:"px-4 py-3 rounded-lg shadow-lg max-w-sm ".concat("success"===e.type?"bg-green-500 text-white":"error"===e.type?"bg-red-500 text-white":"warning"===e.type?"bg-yellow-500 text-white":"bg-blue-500 text-white"),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{children:e.message}),(0,r.jsx)("button",{onClick:()=>removeToast(e.id),className:"ml-2 text-white hover:text-gray-200",children:"\xd7"})]})},e.id))})]})};var i=t(9630);let ErrorBoundary=class ErrorBoundary extends s.Component{static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,a){console.error("ErrorBoundary caught an error:",e,a),this.setState({error:e,errorInfo:a})}render(){return this.state.hasError?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:(0,r.jsxs)("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-12 h-12 mx-auto bg-red-100 dark:bg-red-900/20 rounded-full mb-4",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,r.jsx)("h1",{className:"text-xl font-bold text-gray-900 dark:text-white text-center mb-2",children:"Oops! Algo deu errado"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-6",children:"Ocorreu um erro inesperado. Nossa equipe foi notificada e est\xe1 trabalhando para resolver o problema."}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("button",{onClick:()=>window.location.reload(),className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Recarregar P\xe1gina"}),(0,r.jsx)("button",{onClick:()=>this.setState({hasError:!1,error:null,errorInfo:null}),className:"w-full px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Tentar Novamente"})]}),!1]})}):this.props.children}constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}};var _app=function(e){let{Component:a,pageProps:t}=e;return(0,r.jsx)(ErrorBoundary,{children:(0,r.jsx)(ThemeProvider,{children:(0,r.jsx)(l.Ho,{children:(0,r.jsx)(i.wI,{children:(0,r.jsx)(ToastProvider,{children:(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,r.jsx)(a,{...t})})})})})})})}},415:function(){}},function(e){var __webpack_exec__=function(a){return e(e.s=a)};e.O(0,[774,179],function(){return __webpack_exec__(1118),__webpack_exec__(9974)}),_N_E=e.O()}]);