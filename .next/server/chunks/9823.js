"use strict";exports.id=9823,exports.ids=[9823],exports.modules={9823:(e,r,t)=>{t.d(r,{QO:()=>withAuth});var n=t(9344),i=t.n(n),u=t(7864);function verifyToken(e){try{return i().verify(e,process.env.JWT_SECRET)}catch(e){return null}}async function authenticateUser(e){let r=e.headers.authorization?.replace("Bearer ","");if(!r)return null;let t=verifyToken(r);if(!t)return null;let n=await u._.user.findUnique({where:{id:t.userId}});return n}function withAuth(e){return async(r,t)=>{let n=await authenticateUser(r);return n?(r.user=n,e(r,t)):t.status(401).json({message:"Token inv\xe1lido ou expirado"})}}},7864:(e,r,t)=>{t.d(r,{_:()=>u});var n=t(3524);let i=globalThis,u=i.prisma||new n.PrismaClient}};