"use strict";(()=>{var e={};e.id=3377,e.ids=[3377,2888,660],e.modules={3038:(e,a,t)=>{t.r(a),t.d(a,{config:()=>D,default:()=>v,getServerSideProps:()=>f,getStaticPaths:()=>y,getStaticProps:()=>N,reportWebVitals:()=>k,routeModule:()=>B,unstable_getServerProps:()=>P,unstable_getServerSideProps:()=>A,unstable_getStaticParams:()=>S,unstable_getStaticPaths:()=>C,unstable_getStaticProps:()=>w});var s={};t.r(s),t.d(s,{default:()=>VendasPage});var r=t(7093),l=t(5244),i=t(1323),d=t(9209),n=t.n(d),c=t(9470),o=t(997),x=t(6689),g=t.n(x),m=t(794),h=t(4491),u=t(6522),b=t(3192),j=t(3777),p=t(4207);let components_ClientAnalysis=({salesData:e=[]})=>{let[a,t]=(0,x.useState)([]),[s,r]=(0,x.useState)("all");(0,x.useEffect)(()=>{if(0===e.length)return;let a=e.reduce((e,a)=>{let t=a.client.id;e[t]||(e[t]={client:a.client,sales:[],totalValue:0,totalAnimals:0,lastPurchase:null,frequency:0}),e[t].sales.push(a),e[t].totalValue+=a.totalValue,e[t].totalAnimals+=a.animals.length;let s=new Date(a.saleDate);return(!e[t].lastPurchase||s>new Date(e[t].lastPurchase))&&(e[t].lastPurchase=a.saleDate),e},{}),s=Object.values(a).map(e=>{let a=Math.floor((new Date-new Date(e.lastPurchase))/864e5),t=e.totalValue/e.sales.length,s=e.sales.length,r=0;s>=5?r+=30:s>=3?r+=20:s>=2&&(r+=10),e.totalValue>=5e5?r+=25:e.totalValue>=2e5?r+=20:e.totalValue>=1e5?r+=15:e.totalValue>=5e4&&(r+=10),a<=30?r+=25:a<=60?r+=20:a<=90?r+=15:a<=180&&(r+=10);let l=e.sales.reduce((e,a)=>e+(({Excelente:5,"Muito Bom":4,Bom:3,Regular:2,Ruim:1})[a.satisfaction]||3),0)/e.sales.length,i="Bronze",d="Baixa";(r+=Math.floor(l/5*20))>=80?(i="Diamante",d="Muito Alta"):r>=60?(i="Ouro",d="Alta"):r>=40&&(i="Prata",d="M\xe9dia");let n="Baixo";return a>180?n="Alto":a>90&&(n="M\xe9dio"),{...e,averageTicket:t,purchaseFrequency:s,daysSinceLastPurchase:a,relationshipScore:r,classification:i,priority:d,riskStatus:n,avgSatisfaction:l.toFixed(1)}});s.sort((e,a)=>a.relationshipScore-e.relationshipScore),t(s)},[e]);let formatCurrency=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),getClassificationBadge=e=>{let a={Diamante:o.jsx(j.C,{className:"bg-purple-600 text-white dark:bg-purple-500 dark:text-white",children:"\uD83D\uDC8E Diamante"}),Ouro:o.jsx(j.C,{className:"bg-yellow-600 text-white dark:bg-yellow-500 dark:text-white",children:"\uD83E\uDD47 Ouro"}),Prata:o.jsx(j.C,{className:"bg-gray-600 text-white dark:bg-gray-500 dark:text-white",children:"\uD83E\uDD48 Prata"}),Bronze:o.jsx(j.C,{className:"bg-orange-600 text-white dark:bg-orange-500 dark:text-white",children:"\uD83E\uDD49 Bronze"})};return a[e]||a.Bronze},getRiskBadge=e=>{let a={Alto:o.jsx(j.C,{className:"bg-red-600 text-white dark:bg-red-500 dark:text-white",children:"\uD83D\uDEA8 Alto Risco"}),MÃ©dio:o.jsx(j.C,{className:"bg-yellow-600 text-white dark:bg-yellow-500 dark:text-white",children:"âš ï¸ M\xe9dio Risco"}),Baixo:o.jsx(j.C,{className:"bg-green-600 text-white dark:bg-green-500 dark:text-white",children:"âœ… Baixo Risco"})};return a[e]||a.Baixo},getPriorityColor=e=>{let a={"Muito Alta":"border-l-4 border-purple-500 bg-purple-50 dark:bg-purple-900/20",Alta:"border-l-4 border-red-500 bg-red-50 dark:bg-red-900/20",MÃ©dia:"border-l-4 border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20",Baixa:"border-l-4 border-green-500 bg-green-50 dark:bg-green-900/20"};return a[e]||a.Baixa},l="all"===s?a:a.filter(e=>e.client.segment===s),i=[...new Set(a.map(e=>e.client.segment))],d=a.slice(0,5),n=a.filter(e=>"Alto"===e.riskStatus),c=a.filter(e=>"Diamante"===e.classification);return(0,o.jsxs)("div",{className:"space-y-6",children:[o.jsx(m.Zb,{className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white",children:o.jsx(m.aY,{className:"pt-6",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("h1",{className:"text-3xl font-bold mb-2",children:"\uD83D\uDC65 An\xe1lise de Clientes"}),o.jsx("p",{className:"text-purple-100 text-lg",children:"Classifica\xe7\xe3o e relacionamento com clientes"})]}),(0,o.jsxs)("div",{className:"text-right",children:[o.jsx("div",{className:"text-4xl mb-2",children:"\uD83C\uDFAF"}),(0,o.jsxs)(j.C,{variant:"outline",className:"bg-white/20 text-white border-white/30",children:[a.length," clientes"]})]})]})})}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[o.jsx(m.Zb,{className:"bg-white dark:bg-gray-800 border-2 border-purple-200 dark:border-purple-600 shadow-lg",children:o.jsx(m.aY,{className:"pt-6",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm font-bold text-gray-600 dark:text-gray-300",children:"Clientes Diamante"}),o.jsx("p",{className:"text-3xl font-black text-purple-600 dark:text-purple-400",children:c.length})]}),o.jsx("div",{className:"bg-purple-100 dark:bg-purple-900/30 p-4 rounded-lg",children:o.jsx("span",{className:"text-3xl",children:"\uD83D\uDC8E"})})]})})}),o.jsx(m.Zb,{className:"bg-white dark:bg-gray-800 border-2 border-red-200 dark:border-red-600 shadow-lg",children:o.jsx(m.aY,{className:"pt-6",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm font-bold text-gray-600 dark:text-gray-300",children:"Alto Risco"}),o.jsx("p",{className:"text-3xl font-black text-red-600 dark:text-red-400",children:n.length})]}),o.jsx("div",{className:"bg-red-100 dark:bg-red-900/30 p-4 rounded-lg",children:o.jsx("span",{className:"text-3xl",children:"\uD83D\uDEA8"})})]})})}),o.jsx(m.Zb,{className:"bg-white dark:bg-gray-800 border-2 border-green-200 dark:border-green-600 shadow-lg",children:o.jsx(m.aY,{className:"pt-6",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm font-bold text-gray-600 dark:text-gray-300",children:"Ticket M\xe9dio"}),o.jsx("p",{className:"text-3xl font-black text-green-600 dark:text-green-400",children:formatCurrency(a.reduce((e,a)=>e+a.averageTicket,0)/(a.length||1))})]}),o.jsx("div",{className:"bg-green-100 dark:bg-green-900/30 p-4 rounded-lg",children:o.jsx("span",{className:"text-3xl",children:"\uD83D\uDCB0"})})]})})}),o.jsx(m.Zb,{className:"bg-white dark:bg-gray-800 border-2 border-blue-200 dark:border-blue-600 shadow-lg",children:o.jsx(m.aY,{className:"pt-6",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm font-bold text-gray-600 dark:text-gray-300",children:"Satisfa\xe7\xe3o M\xe9dia"}),o.jsx("p",{className:"text-3xl font-black text-blue-600 dark:text-blue-400",children:(a.reduce((e,a)=>e+parseFloat(a.avgSatisfaction),0)/(a.length||1)).toFixed(1)})]}),o.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-4 rounded-lg",children:o.jsx("span",{className:"text-3xl",children:"â­"})})]})})})]}),(0,o.jsxs)(m.Zb,{children:[o.jsx(m.Ol,{children:o.jsx(m.ll,{children:"\uD83C\uDFC6 Top 5 Clientes (Por Score de Relacionamento)"})}),o.jsx(m.aY,{children:o.jsx("div",{className:"space-y-4",children:d.map((e,a)=>(0,o.jsxs)("div",{className:`p-4 rounded-lg ${getPriorityColor(e.priority)} hover:shadow-md transition-shadow`,children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,o.jsxs)("div",{className:"text-2xl font-bold text-gray-600 dark:text-gray-400",children:["#",a+1]}),(0,o.jsxs)("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:e.client.name}),(0,o.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.client.address.city," - ",e.client.address.state," â€¢ ",e.client.segment]})]})]}),(0,o.jsxs)("div",{className:"text-right",children:[(0,o.jsxs)("div",{className:"flex space-x-2 mb-2",children:[getClassificationBadge(e.classification),getRiskBadge(e.riskStatus)]}),(0,o.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Score: ",(0,o.jsxs)("span",{className:"font-bold",children:[e.relationshipScore,"/100"]})]})]})]}),(0,o.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:[(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:formatCurrency(e.totalValue)}),o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Total Compras"})]}),(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:e.purchaseFrequency}),o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Frequ\xeancia"})]}),(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"text-lg font-bold text-purple-600 dark:text-purple-400",children:formatCurrency(e.averageTicket)}),o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Ticket M\xe9dio"})]}),(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsxs)("div",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:[e.daysSinceLastPurchase,"d"]}),o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"\xdaltima Compra"})]})]})]},e.client.id))})})]}),n.length>0&&(0,o.jsxs)(m.Zb,{className:"border-2 border-red-200 dark:border-red-600",children:[o.jsx(m.Ol,{children:o.jsx(m.ll,{className:"text-red-700 dark:text-red-300",children:"\uD83D\uDEA8 Clientes de Alto Risco - A\xe7\xe3o Necess\xe1ria"})}),o.jsx(m.aY,{children:o.jsx("div",{className:"space-y-4",children:n.map(e=>(0,o.jsxs)("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-700",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,o.jsxs)("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:e.client.name}),(0,o.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["\xdaltima compra h\xe1 ",e.daysSinceLastPurchase," dias"]})]}),(0,o.jsxs)("div",{className:"text-right",children:[o.jsx("div",{className:"text-lg font-bold text-red-600 dark:text-red-400 mb-1",children:formatCurrency(e.totalValue)}),o.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total hist\xf3rico"})]})]}),(0,o.jsxs)("div",{className:"flex justify-end space-x-2",children:[o.jsx(h.z,{size:"sm",className:"bg-red-600 hover:bg-red-700",onClick:()=>{alert(`A\xe7\xe3o de reten\xe7\xe3o iniciada para ${e.client.name}!`)},children:"\uD83D\uDCDE Contatar Urgente"}),o.jsx(h.z,{variant:"outline",size:"sm",onClick:()=>{alert(`Oferta especial preparada para ${e.client.name}!`)},children:"\uD83C\uDF81 Oferta Especial"})]})]},e.client.id))})})]}),(0,o.jsxs)(m.Zb,{children:[o.jsx(m.Ol,{children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[o.jsx(m.ll,{children:"\uD83D\uDCCA Todos os Clientes"}),o.jsx("div",{children:(0,o.jsxs)("select",{value:s,onChange:e=>r(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[o.jsx("option",{value:"all",children:"Todos os Segmentos"}),i.map(e=>o.jsx("option",{value:e,children:e},e))]})})]})}),o.jsx(m.aY,{children:o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(e=>(0,o.jsxs)("div",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:shadow-md transition-shadow bg-gray-50 dark:bg-gray-700",children:[(0,o.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,o.jsxs)("div",{children:[o.jsx("h3",{className:"font-bold text-gray-900 dark:text-white text-sm",children:e.client.name}),(0,o.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[e.client.address.city," - ",e.client.address.state]})]}),o.jsx("div",{className:"text-right",children:getClassificationBadge(e.classification)})]}),(0,o.jsxs)("div",{className:"space-y-2 text-xs",children:[(0,o.jsxs)("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Total:"}),o.jsx("span",{className:"font-bold text-gray-900 dark:text-white",children:formatCurrency(e.totalValue)})]}),(0,o.jsxs)("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Frequ\xeancia:"}),(0,o.jsxs)("span",{className:"font-bold text-gray-900 dark:text-white",children:[e.purchaseFrequency," compras"]})]}),(0,o.jsxs)("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Score:"}),(0,o.jsxs)("span",{className:"font-bold text-gray-900 dark:text-white",children:[e.relationshipScore,"/100"]})]}),(0,o.jsxs)("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Risco:"}),getRiskBadge(e.riskStatus)]})]})]},e.client.id))})})]})]})},components_SalesReport=()=>{let[e,a]=(0,x.useState)([]),[t,s]=(0,x.useState)([]),[r,l]=(0,x.useState)("all"),[i,d]=(0,x.useState)("all"),[n,c]=(0,x.useState)("all"),[v,N]=(0,x.useState)(""),[y,f]=(0,x.useState)(null),[D,k]=(0,x.useState)({}),[w,C]=(0,x.useState)("sales"),[S,P]=(0,x.useState)(!1);(0,x.useEffect)(()=>{loadRealSalesData()},[]);let loadRealSalesData=async()=>{try{let e=await fetch("/api/sales-list"),t=await e.json(),r=await fetch("/api/animals-list"),l=await r.json();if(console.log("Vendas carregadas:",t.length),console.log("Animais carregados:",l.length),0===t.length&&l.length>0)a([]),s([]);else{let e=convertRealSalesToFormat(t);a(e),s(e)}}catch(e){console.error("Erro ao carregar dados reais:",e),loadMockData()}},loadMockData=()=>{a([]),s([])},convertRealSalesToFormat=e=>e.map((e,a)=>({id:e.id,saleDate:e.dataVenda,client:{id:`CLI${String(a+1).padStart(3,"0")}`,name:e.nomeComprador||`Cliente ${a+1}`,cnpj:e.cnpjComprador||"00.000.000/0001-00",contact:e.contatoComprador||"N\xe3o informado",phone:e.telefoneComprador||"N\xe3o informado",email:e.emailComprador||"nao-informado@email.com",address:{street:"N\xe3o informado",city:e.cidadeComprador||"N\xe3o informado",state:e.estadoComprador||"SP",zipCode:"00000-000"},segment:"Cliente Real",clientSince:e.createdAt,totalPurchases:e.valorVenda,averageTicket:e.valorVenda,paymentTerms:"30 dias",creditLimit:5e5,lastPurchase:e.dataVenda},animals:[{id:e.animal?.brinco||e.animalId,breed:e.animal?.raca||"Nelore",weight:e.pesoVenda||450,age:24,gender:e.animal?.sexo==="MACHO"?"M":"F",unitPrice:e.precoKg||280,totalPrice:e.valorVenda,category:e.animal?.sexo==="MACHO"?"Terminado":"Matriz",name:e.animal?.nome}],totalValue:e.valorVenda,totalWeight:e.pesoVenda||450,averagePrice:e.precoKg||280,paymentStatus:"Pendente",paymentDate:null,deliveryDate:e.dataVenda,transportCompany:"N\xe3o informado",notes:e.observacoes||"Venda real do sistema",satisfaction:"Bom",followUpDate:new Date(Date.now()+2592e6).toISOString().split("T")[0],followUpStatus:"Pendente"}));(0,x.useEffect)(()=>{let a=e;if("all"!==r){let e=new Date,t=new Date(e.getTime()-864e5*({"7d":7,"30d":30,"90d":90,"180d":180,"365d":365})[r]);a=a.filter(e=>new Date(e.saleDate)>=t)}"all"!==i&&(a=a.filter(e=>e.client.address.state===i)),"all"!==n&&(a=a.filter(e=>e.client.id===n)),v&&(a=a.filter(e=>e.client.name.toLowerCase().includes(v.toLowerCase())||e.client.contact.toLowerCase().includes(v.toLowerCase())||e.client.cnpj.includes(v))),s(a)},[e,r,i,n,v]);let formatCurrency=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),formatDate=e=>new Date(e).toLocaleDateString("pt-BR"),getPaymentStatusBadge=e=>{let a={Pago:o.jsx(j.C,{className:"bg-green-600 text-white dark:bg-green-500 dark:text-white",children:"âœ… Pago"}),Pendente:o.jsx(j.C,{className:"bg-yellow-600 text-white dark:bg-yellow-500 dark:text-white",children:"â³ Pendente"}),Atrasado:o.jsx(j.C,{className:"bg-red-600 text-white dark:bg-red-500 dark:text-white",children:"\uD83D\uDEA8 Atrasado"})};return a[e]||a.Pendente},getSatisfactionBadge=e=>{let a={Excelente:o.jsx(j.C,{className:"bg-green-600 text-white dark:bg-green-500 dark:text-white",children:"\uD83D\uDE0D Excelente"}),"Muito Bom":o.jsx(j.C,{className:"bg-blue-600 text-white dark:bg-blue-500 dark:text-white",children:"\uD83D\uDE0A Muito Bom"}),Bom:o.jsx(j.C,{className:"bg-yellow-600 text-white dark:bg-yellow-500 dark:text-white",children:"\uD83D\uDE42 Bom"}),Regular:o.jsx(j.C,{className:"bg-orange-600 text-white dark:bg-orange-500 dark:text-white",children:"\uD83D\uDE10 Regular"}),Ruim:o.jsx(j.C,{className:"bg-red-600 text-white dark:bg-red-500 dark:text-white",children:"\uD83D\uDE1E Ruim"})};return a[e]||a.Bom},getFollowUpStatusBadge=e=>{let a={Realizado:o.jsx(j.C,{className:"bg-green-600 text-white dark:bg-green-500 dark:text-white",children:"âœ… Realizado"}),Pendente:o.jsx(j.C,{className:"bg-yellow-600 text-white dark:bg-yellow-500 dark:text-white",children:"\uD83D\uDCC5 Pendente"}),Agendado:o.jsx(j.C,{className:"bg-blue-600 text-white dark:bg-blue-500 dark:text-white",children:"\uD83D\uDCDE Agendado"})};return a[e]||a.Pendente},A=t.reduce((e,a)=>e+a.totalValue,0),B=t.reduce((e,a)=>e+a.animals.length,0),R=t.length>0?A/t.length:0,E=[...new Set(t.map(e=>e.client.id))],V=[...new Set(e.map(e=>e.client.address.state))],handleFollowUpNote=(e,a)=>{k(t=>({...t,[e]:a}))};return(0,o.jsxs)("div",{className:"space-y-6",children:[o.jsx(m.Zb,{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white",children:o.jsx(m.aY,{className:"pt-6",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("h1",{className:"text-3xl font-bold mb-2",children:"\uD83D\uDCCA Relat\xf3rio de Vendas por Cliente"}),o.jsx("p",{className:"text-blue-100 text-lg",children:"Sistema completo para an\xe1lise e p\xf3s-venda"})]}),(0,o.jsxs)("div",{className:"text-right",children:[o.jsx("div",{className:"text-4xl mb-2",children:"\uD83C\uDFAF"}),(0,o.jsxs)("div",{className:"flex space-x-2",children:[o.jsx(h.z,{variant:"sales"===w?"default":"outline",size:"sm",onClick:()=>C("sales"),className:"sales"===w?"bg-white text-blue-600":"bg-white/20 text-white border-white/30",children:"\uD83D\uDCCB Vendas"}),o.jsx(h.z,{variant:"analysis"===w?"default":"outline",size:"sm",onClick:()=>C("analysis"),className:"analysis"===w?"bg-white text-blue-600":"bg-white/20 text-white border-white/30",children:"\uD83D\uDC65 An\xe1lise Clientes"}),o.jsx(h.z,{variant:"bi"===w?"default":"outline",size:"sm",onClick:()=>C("bi"),className:"bi"===w?"bg-white text-blue-600":"bg-white/20 text-white border-white/30",children:"\uD83D\uDCCA BI Analytics"})]})]})]})})}),"analysis"===w?o.jsx(components_ClientAnalysis,{salesData:e}):"bi"===w?o.jsx(()=>{let[e,a]=(0,x.useState)([]),[s,r]=(0,x.useState)("30"),[l,i]=(0,x.useState)(""),[d,n]=(0,x.useState)(!1);g().useEffect(()=>{loadBIData()},[]);let loadBIData=async()=>{try{let e=await fetch("/api/sales-data"),s=await e.json();if(s.hasRealSales)a(s.sales);else{let e=t.map(e=>({date:e.saleDate,vendas:e.animals.length,valor:e.totalValue,categoria:e.client.segment,regiao:e.client.address.state,animal:e.animals[0]}));a(e)}}catch(s){console.error("Erro ao carregar dados BI:",s);let e=t.map(e=>({date:e.saleDate,vendas:e.animals.length,valor:e.totalValue,categoria:e.client.segment,regiao:e.client.address.state}));a(e)}},handleSendWhatsApp=async e=>{if(!l){n(!0);return}try{console.log("Enviando relat\xf3rio BI via WhatsApp:",{to:l,message:e.substring(0,100)+"..."}),alert("Relat\xf3rio BI enviado via WhatsApp com sucesso!"),n(!1)}catch(e){console.error("Erro ao enviar WhatsApp:",e),alert("Erro ao enviar relat\xf3rio via WhatsApp")}},generateBIReport=()=>{let a=e.reduce((e,a)=>e+a.vendas,0),t=e.reduce((e,a)=>e+a.valor,0),r=a>0?t/a:0,l={};e.forEach(e=>{l[e.categoria]||(l[e.categoria]={vendas:0,valor:0}),l[e.categoria].vendas+=e.vendas,l[e.categoria].valor+=e.valor});let i=Object.entries(l).map(([e,a])=>({categoria:e,vendas:a.vendas,valor:a.valor,participacao:(a.valor/t*100).toFixed(1)})).sort((e,a)=>a.valor-e.valor),d=`
ðŸ„ *RELAT\xd3RIO BI - VENDAS DE GADO*
ðŸ“… Per\xedodo: \xdaltimos ${s} dias

ðŸ“Š *RESUMO EXECUTIVO*
â€¢ Total de Vendas: ${a} cabe\xe7as
â€¢ Receita Total: R$ ${(t/1e3).toFixed(0)}k
â€¢ Ticket M\xe9dio: R$ ${(r/1e3).toFixed(1)}k
â€¢ Vendas/Dia: ${Math.round(a/parseInt(s))} cabe\xe7as

ðŸ“ˆ *AN\xc1LISE POR SEGMENTO*
${i.map(e=>`â€¢ ${e.categoria}: ${e.vendas} vendas (${e.participacao}%)`).join("\n")}

ðŸ’¡ *INSIGHTS*
â€¢ ${i.length>0?i[0].categoria:"N/A"} lidera com ${i.length>0?i[0].participacao:"0"}% das vendas
â€¢ Performance ${a>50?"excelente":a>20?"boa":"regular"} no per\xedodo
â€¢ Ticket m\xe9dio ${r>1e5?"alto":r>5e4?"m\xe9dio":"baixo"}

---
ðŸ¤– Relat\xf3rio gerado automaticamente pelo BeefSync
ðŸ“± Sistema de Gest\xe3o de Leil\xe3o
      `.trim();return d};return(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsxs)(m.Zb,{children:[o.jsx(m.Ol,{children:(0,o.jsxs)(m.ll,{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-3",children:[o.jsx("span",{children:"\uD83D\uDCCA Business Intelligence - An\xe1lise de Vendas"}),o.jsx(j.C,{className:e.length>0&&e[0].animal?"bg-green-600":"bg-yellow-600",children:e.length>0&&e[0].animal?"âœ… Dados Reais":"âš ï¸ Demo"})]}),(0,o.jsxs)("div",{className:"flex space-x-2",children:[o.jsx(h.z,{onClick:loadBIData,size:"sm",variant:"outline",children:"\uD83D\uDD04 Atualizar"}),(0,o.jsxs)(b.Ph,{value:s,onValueChange:r,children:[o.jsx("option",{value:"7",children:"\xdaltimos 7 dias"}),o.jsx("option",{value:"30",children:"\xdaltimos 30 dias"}),o.jsx("option",{value:"90",children:"\xdaltimos 90 dias"}),o.jsx("option",{value:"365",children:"\xdaltimo ano"})]}),o.jsx(h.z,{onClick:()=>n(!0),className:"bg-green-600 hover:bg-green-700",children:"\uD83D\uDCF1 Enviar WhatsApp"})]})]})}),o.jsx(m.aY,{children:o.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.length>0&&e[0].animal?`ðŸ“Š Analisando ${e.length} vendas reais com animais importados`:`âš ï¸ Usando dados de demonstra\xe7\xe3o. Importe animais e registre vendas para ver dados reais.`})})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsx(m.Zb,{className:"bg-gradient-to-r from-green-500 to-green-600 text-white",children:o.jsx(m.aY,{className:"pt-6",children:(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"text-3xl font-bold",children:e.reduce((e,a)=>e+a.vendas,0)}),o.jsx("div",{className:"text-green-100",children:"Total de Vendas"})]})})}),o.jsx(m.Zb,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:o.jsx(m.aY,{className:"pt-6",children:(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsxs)("div",{className:"text-3xl font-bold",children:["R$ ",(e.reduce((e,a)=>e+a.valor,0)/1e3).toFixed(0),"k"]}),o.jsx("div",{className:"text-blue-100",children:"Receita Total"})]})})}),o.jsx(m.Zb,{className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:o.jsx(m.aY,{className:"pt-6",children:(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsxs)("div",{className:"text-3xl font-bold",children:["R$ ",e.length>0?(e.reduce((e,a)=>e+a.valor,0)/e.reduce((e,a)=>e+a.vendas,0)/1e3).toFixed(1):0,"k"]}),o.jsx("div",{className:"text-purple-100",children:"Ticket M\xe9dio"})]})})}),o.jsx(m.Zb,{className:"bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:o.jsx(m.aY,{className:"pt-6",children:(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"text-3xl font-bold",children:Math.round(e.reduce((e,a)=>e+a.vendas,0)/Math.max(parseInt(s),1))}),o.jsx("div",{className:"text-orange-100",children:"Vendas/Dia"})]})})})]}),(0,o.jsxs)(m.Zb,{children:[o.jsx(m.Ol,{children:o.jsx(m.ll,{children:"\uD83D\uDCC8 Evolu\xe7\xe3o de Vendas por Per\xedodo"})}),o.jsx(m.aY,{children:o.jsx("div",{className:"h-64 flex items-end justify-between bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:e.slice(-10).map((a,t)=>{let s=Math.max(...e.map(e=>e.valor)),r=a.valor/s*200;return(0,o.jsxs)("div",{className:"flex flex-col items-center",children:[o.jsx("div",{className:"bg-gradient-to-t from-blue-600 to-purple-600 rounded-t w-8 transition-all duration-1000",style:{height:`${r}px`},title:`${new Date(a.date).toLocaleDateString("pt-BR")}: R$ ${a.valor.toLocaleString("pt-BR")}`}),o.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-2 transform -rotate-45",children:new Date(a.date).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})})]},t)})})})]}),e.length>0&&e[0].animal&&(0,o.jsxs)(m.Zb,{children:[o.jsx(m.Ol,{children:o.jsx(m.ll,{children:"\uD83D\uDC04 Animais Inclu\xeddos na An\xe1lise"})}),(0,o.jsxs)(m.aY,{children:[o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:e.slice(0,6).map((e,a)=>(0,o.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-lg border",children:[(0,o.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,o.jsxs)("div",{children:[o.jsx("span",{className:"font-bold text-gray-900 dark:text-white",children:e.animal.id}),o.jsx(j.C,{className:"ml-2 bg-blue-600 text-white",children:e.animal.raca})]}),(0,o.jsxs)("span",{className:"text-lg font-bold text-green-600",children:["R$ ",(e.valor/1e3).toFixed(0),"k"]})]}),(0,o.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[o.jsx("strong",{children:"Nome:"})," ",e.animal.nome||"N\xe3o informado",o.jsx("br",{}),o.jsx("strong",{children:"Sexo:"})," ",e.animal.sexo,o.jsx("br",{}),o.jsx("strong",{children:"Data:"})," ",new Date(e.date).toLocaleDateString("pt-BR")]})]},a))}),e.length>6&&o.jsx("div",{className:"text-center mt-4",children:(0,o.jsxs)(j.C,{variant:"outline",children:["+",e.length-6," animais adicionais na an\xe1lise"]})})]})]}),(0,o.jsxs)(m.Zb,{children:[o.jsx(m.Ol,{children:o.jsx(m.ll,{children:"\uD83C\uDFAF An\xe1lise por Segmento de Cliente"})}),o.jsx(m.aY,{children:o.jsx("div",{className:"space-y-4",children:(()=>{let a={};e.forEach(e=>{a[e.categoria]||(a[e.categoria]={vendas:0,valor:0}),a[e.categoria].vendas+=e.vendas,a[e.categoria].valor+=e.valor});let t=Object.values(a).reduce((e,a)=>e+a.valor,0);return Object.entries(a).sort(([,e],[,a])=>a.valor-e.valor).map(([e,a])=>{let s=t>0?a.valor/t*100:0;return(0,o.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-4 h-4 bg-gradient-to-r from-blue-500 to-purple-500 rounded"}),o.jsx("span",{className:"font-medium",children:e})]}),(0,o.jsxs)("div",{className:"text-right",children:[o.jsx("div",{className:"font-bold text-green-600",children:formatCurrency(a.valor)}),(0,o.jsxs)("div",{className:"text-sm text-gray-500",children:[a.vendas," vendas (",s.toFixed(1),"%)"]})]})]},e)})})()})})]}),(0,o.jsxs)(m.Zb,{children:[o.jsx(m.Ol,{children:o.jsx(m.ll,{children:"\uD83D\uDCCB Preview do Relat\xf3rio BI"})}),(0,o.jsxs)(m.aY,{children:[o.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:o.jsx("pre",{className:"text-sm whitespace-pre-wrap text-gray-700 dark:text-gray-300",children:generateBIReport()})}),(0,o.jsxs)("div",{className:"mt-4 flex space-x-2",children:[o.jsx(h.z,{onClick:()=>n(!0),className:"bg-green-600 hover:bg-green-700",children:"\uD83D\uDCF1 Enviar via WhatsApp"}),o.jsx(h.z,{onClick:()=>{let e=document.createElement("a"),a=new Blob([generateBIReport()],{type:"text/plain"});e.href=URL.createObjectURL(a),e.download=`relatorio-bi-${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(e),e.click(),document.body.removeChild(e)},variant:"outline",children:"\uD83D\uDCE5 Download TXT"})]})]})]}),d&&o.jsx(()=>o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,o.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 max-w-md w-full mx-4",children:[o.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Enviar Relat\xf3rio BI via WhatsApp"}),(0,o.jsxs)("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"N\xfamero do WhatsApp"}),o.jsx(u.I,{type:"text",value:l,onChange:e=>i(e.target.value),placeholder:"+55 11 99999-9999"})]}),(0,o.jsxs)("div",{className:"flex space-x-3",children:[o.jsx(h.z,{onClick:()=>n(!1),variant:"outline",className:"flex-1",children:"Cancelar"}),o.jsx(h.z,{onClick:()=>{l&&handleSendWhatsApp(generateBIReport())},className:"flex-1 bg-green-600 hover:bg-green-700",children:"\uD83D\uDCF1 Enviar"})]})]})}),{})]})},{}):(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsxs)(m.Zb,{children:[o.jsx(m.Ol,{children:o.jsx(m.ll,{children:"\uD83D\uDD0D Filtros e Busca"})}),o.jsx(m.aY,{children:(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Per\xedodo"}),(0,o.jsxs)(b.Ph,{value:r,onValueChange:l,children:[o.jsx("option",{value:"all",children:"Todos os per\xedodos"}),o.jsx("option",{value:"7d",children:"\xdaltimos 7 dias"}),o.jsx("option",{value:"30d",children:"\xdaltimos 30 dias"}),o.jsx("option",{value:"90d",children:"\xdaltimos 90 dias"}),o.jsx("option",{value:"180d",children:"\xdaltimos 6 meses"}),o.jsx("option",{value:"365d",children:"\xdaltimo ano"})]})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Estado"}),(0,o.jsxs)(b.Ph,{value:i,onValueChange:d,children:[o.jsx("option",{value:"all",children:"Todos os estados"}),V.map(e=>o.jsx("option",{value:e,children:e},e))]})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Cliente"}),(0,o.jsxs)(b.Ph,{value:n,onValueChange:c,children:[o.jsx("option",{value:"all",children:"Todos os clientes"}),E.map(a=>{let t=e.find(e=>e.client.id===a)?.client;return o.jsx("option",{value:a,children:t?.name},a)})]})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Buscar"}),o.jsx(u.I,{placeholder:"Nome, CNPJ ou contato...",value:v,onChange:e=>N(e.target.value)})]}),(0,o.jsxs)("div",{className:"flex items-end space-x-2",children:[o.jsx(h.z,{onClick:loadRealSalesData,className:"bg-blue-600 hover:bg-blue-700",children:"\uD83D\uDD04 Recarregar Dados"}),o.jsx(h.z,{onClick:()=>{let e=t.map(e=>[formatDate(e.saleDate),e.client.name,e.client.cnpj,e.client.contact,e.client.phone,e.client.email,e.client.address.city,e.client.address.state,e.client.segment,e.totalValue,e.animals.length,e.totalWeight,e.averagePrice.toFixed(2),e.paymentStatus,e.satisfaction,e.followUpStatus,e.notes]),a=[["Data Venda","Cliente","CNPJ","Contato","Telefone","Email","Cidade","Estado","Segmento","Valor Total","Qtd Animais","Peso Total","Pre\xe7o M\xe9dio","Status Pagamento","Satisfa\xe7\xe3o","Follow-up","Observa\xe7\xf5es"],...e].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n"),s=new Blob([a],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download=`relatorio_vendas_${new Date().toISOString().split("T")[0]}.csv`,r.click()},className:"bg-green-600 hover:bg-green-700",children:"\uD83D\uDCE5 Exportar CSV"})]})]})})]}),o.jsx(m.Zb,{className:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-600",children:o.jsx(m.aY,{className:"pt-6",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-blue-900 dark:text-blue-100 mb-2",children:"\uD83D\uDCCA Status dos Dados"}),o.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:e.length>0&&e[0].notes?.includes("animal real")?`âœ… Dados baseados em ${e.reduce((e,a)=>e+a.animals.length,0)} animais reais importados`:e.length>0&&e[0].client?.name?.includes("Cliente Real")?`âœ… ${e.length} vendas reais carregadas do sistema`:`âš ï¸ Usando dados de demonstra\xe7\xe3o (${e.length} vendas)`})]}),o.jsx(h.z,{onClick:loadRealSalesData,size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:"\uD83D\uDD04 Atualizar"})]})})}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[o.jsx(m.Zb,{className:"bg-white dark:bg-gray-800 border-2 border-green-200 dark:border-green-600 shadow-lg",children:o.jsx(m.aY,{className:"pt-6",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm font-bold text-gray-600 dark:text-gray-300",children:"Total Vendas"}),o.jsx("p",{className:"text-3xl font-black text-green-600 dark:text-green-400",children:formatCurrency(A)})]}),o.jsx("div",{className:"bg-green-100 dark:bg-green-900/30 p-4 rounded-lg",children:o.jsx("span",{className:"text-3xl",children:"\uD83D\uDCB0"})})]})})}),o.jsx(m.Zb,{className:"bg-white dark:bg-gray-800 border-2 border-blue-200 dark:border-blue-600 shadow-lg",children:o.jsx(m.aY,{className:"pt-6",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm font-bold text-gray-600 dark:text-gray-300",children:"Total Animais"}),o.jsx("p",{className:"text-3xl font-black text-blue-600 dark:text-blue-400",children:B})]}),o.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-4 rounded-lg",children:o.jsx("span",{className:"text-3xl",children:"\uD83D\uDC04"})})]})})}),o.jsx(m.Zb,{className:"bg-white dark:bg-gray-800 border-2 border-purple-200 dark:border-purple-600 shadow-lg",children:o.jsx(m.aY,{className:"pt-6",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm font-bold text-gray-600 dark:text-gray-300",children:"Ticket M\xe9dio"}),o.jsx("p",{className:"text-3xl font-black text-purple-600 dark:text-purple-400",children:formatCurrency(R)})]}),o.jsx("div",{className:"bg-purple-100 dark:bg-purple-900/30 p-4 rounded-lg",children:o.jsx("span",{className:"text-3xl",children:"\uD83D\uDCCA"})})]})})}),o.jsx(m.Zb,{className:"bg-white dark:bg-gray-800 border-2 border-orange-200 dark:border-orange-600 shadow-lg",children:o.jsx(m.aY,{className:"pt-6",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm font-bold text-gray-600 dark:text-gray-300",children:"Clientes \xdanicos"}),o.jsx("p",{className:"text-3xl font-black text-orange-600 dark:text-orange-400",children:E.length})]}),o.jsx("div",{className:"bg-orange-100 dark:bg-orange-900/30 p-4 rounded-lg",children:o.jsx("span",{className:"text-3xl",children:"\uD83D\uDC65"})})]})})})]}),(0,o.jsxs)(m.Zb,{children:[o.jsx(m.Ol,{children:(0,o.jsxs)(m.ll,{children:["\uD83D\uDCCB Vendas Detalhadas (",t.length,")"]})}),o.jsx(m.aY,{children:o.jsx("div",{className:"space-y-6",children:t.map(e=>(0,o.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-6 hover:shadow-lg transition-shadow bg-gray-50 dark:bg-gray-700",children:[(0,o.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,o.jsxs)("div",{children:[o.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-1",children:e.client.name}),(0,o.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Venda #",e.id," â€¢ ",formatDate(e.saleDate)]})]}),(0,o.jsxs)("div",{className:"text-right",children:[o.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400 mb-1",children:formatCurrency(e.totalValue)}),(0,o.jsxs)("div",{className:"flex space-x-2",children:[getPaymentStatusBadge(e.paymentStatus),getSatisfactionBadge(e.satisfaction)]})]})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4 p-4 bg-white dark:bg-gray-800 rounded-lg",children:[(0,o.jsxs)("div",{children:[o.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"\uD83D\uDCDE Contato"}),(0,o.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[o.jsx("strong",{children:"Respons\xe1vel:"})," ",e.client.contact,o.jsx("br",{}),o.jsx("strong",{children:"Telefone:"})," ",e.client.phone,o.jsx("br",{}),o.jsx("strong",{children:"Email:"})," ",e.client.email]})]}),(0,o.jsxs)("div",{children:[o.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"\uD83D\uDCCD Localiza\xe7\xe3o"}),(0,o.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.client.address.city," -"," ",e.client.address.state,o.jsx("br",{}),o.jsx("strong",{children:"CEP:"})," ",e.client.address.zipCode,o.jsx("br",{}),o.jsx("strong",{children:"Segmento:"})," ",e.client.segment]})]}),(0,o.jsxs)("div",{children:[o.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"\uD83D\uDCBC Hist\xf3rico"}),(0,o.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[o.jsx("strong",{children:"Cliente desde:"})," ",formatDate(e.client.clientSince),o.jsx("br",{}),o.jsx("strong",{children:"Total compras:"})," ",formatCurrency(e.client.totalPurchases),o.jsx("br",{}),o.jsx("strong",{children:"Ticket m\xe9dio:"})," ",formatCurrency(e.client.averageTicket)]})]}),(0,o.jsxs)("div",{children:[o.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"\uD83D\uDCB3 Financeiro"}),(0,o.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[o.jsx("strong",{children:"Prazo:"})," ",e.client.paymentTerms,o.jsx("br",{}),o.jsx("strong",{children:"Limite:"})," ",formatCurrency(e.client.creditLimit),o.jsx("br",{}),o.jsx("strong",{children:"CNPJ:"})," ",e.client.cnpj]})]})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsxs)("h4",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:["\uD83D\uDC04 Animais Vendidos (",e.animals.length,")"]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:e.animals.map(e=>(0,o.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-lg border border-gray-200 dark:border-gray-600",children:[(0,o.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,o.jsxs)("div",{children:[o.jsx("span",{className:"font-bold text-gray-900 dark:text-white",children:e.id}),o.jsx(j.C,{className:"ml-2 bg-blue-600 text-white dark:bg-blue-500 dark:text-white",children:e.category})]}),o.jsx("span",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:formatCurrency(e.totalPrice)})]}),(0,o.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[o.jsx("strong",{children:"Ra\xe7a:"})," ",e.breed," â€¢"," ",o.jsx("strong",{children:"Peso:"})," ",e.weight,"kg",o.jsx("br",{}),o.jsx("strong",{children:"Idade:"})," ",e.age," meses â€¢"," ",o.jsx("strong",{children:"Sexo:"})," ",e.gender,o.jsx("br",{}),o.jsx("strong",{children:"Pre\xe7o/kg:"})," R$"," ",e.unitPrice.toFixed(2)]})]},e.id))})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsxs)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:[e.totalWeight,"kg"]}),o.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Peso Total"})]}),(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsxs)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:["R$ ",e.averagePrice.toFixed(2)]}),o.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Pre\xe7o M\xe9dio/kg"})]}),(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:e.animals.length}),o.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Animais"})]})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4 p-4 bg-gray-100 dark:bg-gray-600 rounded-lg",children:[(0,o.jsxs)("div",{children:[o.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"\uD83D\uDE9B Log\xedstica"}),(0,o.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[o.jsx("strong",{children:"Transportadora:"})," ",e.transportCompany,o.jsx("br",{}),o.jsx("strong",{children:"Data Entrega:"})," ",formatDate(e.deliveryDate),o.jsx("br",{}),o.jsx("strong",{children:"Status:"})," Entregue"]})]}),(0,o.jsxs)("div",{children:[o.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"\uD83D\uDCB0 Pagamento"}),(0,o.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[o.jsx("strong",{children:"Status:"})," ",e.paymentStatus,o.jsx("br",{}),o.jsx("strong",{children:"Data Pagamento:"})," ",e.paymentDate?formatDate(e.paymentDate):"Pendente",o.jsx("br",{}),o.jsx("strong",{children:"Prazo:"})," ",e.client.paymentTerms]})]})]}),(0,o.jsxs)("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:"\uD83D\uDCDE P\xf3s-Venda"}),(0,o.jsxs)("div",{className:"flex space-x-2",children:[getFollowUpStatusBadge(e.followUpStatus),(0,o.jsxs)(j.C,{className:"bg-gray-600 text-white dark:bg-gray-500 dark:text-white",children:["\uD83D\uDCC5 ",formatDate(e.followUpDate)]})]})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:o.jsx("strong",{children:"Observa\xe7\xf5es da venda:"})}),o.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 p-2 rounded",children:e.notes})]}),(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:o.jsx("strong",{children:"Notas de follow-up:"})}),o.jsx(p.g,{placeholder:"Adicionar notas do follow-up...",value:D[e.id]||"",onChange:a=>handleFollowUpNote(e.id,a.target.value),rows:3,className:"text-sm"})]})]}),(0,o.jsxs)("div",{className:"flex justify-end space-x-2",children:[o.jsx(h.z,{variant:"outline",size:"sm",onClick:()=>window.open(`tel:${e.client.phone}`),children:"\uD83D\uDCDE Ligar"}),o.jsx(h.z,{variant:"outline",size:"sm",onClick:()=>window.open(`mailto:${e.client.email}`),children:"\uD83D\uDCE7 Email"}),o.jsx(h.z,{variant:"outline",size:"sm",onClick:()=>window.open(`https://wa.me/${e.client.phone.replace(/\D/g,"")}`),children:"\uD83D\uDCAC WhatsApp"}),o.jsx(h.z,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>{alert(`Follow-up agendado para ${e.client.name}!`)},children:"âœ… Marcar Follow-up"})]})]})]},e.id))})})]})]})]})};function VendasPage(){return o.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-6",children:o.jsx(components_SalesReport,{})})}let v=(0,i.l)(s,"default"),N=(0,i.l)(s,"getStaticProps"),y=(0,i.l)(s,"getStaticPaths"),f=(0,i.l)(s,"getServerSideProps"),D=(0,i.l)(s,"config"),k=(0,i.l)(s,"reportWebVitals"),w=(0,i.l)(s,"unstable_getStaticProps"),C=(0,i.l)(s,"unstable_getStaticPaths"),S=(0,i.l)(s,"unstable_getStaticParams"),P=(0,i.l)(s,"unstable_getServerProps"),A=(0,i.l)(s,"unstable_getServerSideProps"),B=new r.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/vendas",pathname:"/vendas",bundlePath:"",filename:""},components:{App:c.default,Document:n()},userland:s})},3777:(e,a,t)=>{t.d(a,{C:()=>Badge});var s=t(997);t(6689);let Badge=({children:e,variant:a="default",className:t="",...r})=>s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium transition-colors ${{default:"bg-blue-600 text-white dark:bg-blue-500 dark:text-white",outline:"border border-gray-300 bg-transparent text-gray-700 dark:border-gray-600 dark:text-gray-300",success:"bg-green-600 text-white dark:bg-green-500 dark:text-white",warning:"bg-yellow-600 text-white dark:bg-yellow-500 dark:text-white",error:"bg-red-600 text-white dark:bg-red-500 dark:text-white",secondary:"bg-gray-600 text-white dark:bg-gray-500 dark:text-white"}[a]} ${t}`,...r,children:e})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},997:e=>{e.exports=require("react/jsx-runtime")},1017:e=>{e.exports=require("path")}};var a=require("../webpack-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),t=a.X(0,[9209,8450,9470,794,4491,1867],()=>__webpack_exec__(3038));module.exports=t})();