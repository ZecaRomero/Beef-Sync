"use strict";(()=>{var e={};e.id=7166,e.ids=[7166],e.modules={3524:e=>{e.exports=require("@prisma/client")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},1079:(e,a,o)=>{o.r(a),o.d(a,{config:()=>u,default:()=>c,routeModule:()=>l});var r={};o.r(r),o.d(r,{default:()=>handler});var t=o(1802),s=o(7153),i=o(8781),n=o(3524);let d=new n.PrismaClient;async function handler(e,a){if("GET"===e.method)try{let e=await d.semenContainer.findMany({include:{canecas:{include:{semenStock:{select:{quantidadeDisponivel:!0}}}},user:{select:{name:!0}}},orderBy:{botijaoNumero:"asc"}}),o=e.map(e=>({id:e.id,botijaoNumero:e.botijaoNumero,marca:e.marca,modelo:e.modelo,capacidade:e.capacidade,dataAquisicao:e.dataAquisicao,status:e.status.toLowerCase(),temperatura:e.temperatura,nivelNitrogeno:e.nivelNitrogeno,proximaManutencao:e.proximaManutencao,canecas:e.canecas.map(e=>({id:e.id,numero:e.numero,capacidade:e.capacidade,ocupacao:e.semenStock.reduce((e,a)=>e+a.quantidadeDisponivel,0),posicoes:e.posicoes}))}));a.status(200).json(o)}catch(e){console.error("Erro ao buscar containers:",e),a.status(500).json({error:"Erro interno do servidor"})}else if("POST"===e.method)try{let{botijaoNumero:o,marca:r,modelo:t,capacidade:s,dataAquisicao:i,temperatura:n,nivelNitrogeno:c,proximaManutencao:u,observacoes:l}=e.body;if(!o)return a.status(400).json({error:"N\xfamero do botij\xe3o \xe9 obrigat\xf3rio"});let m=await d.semenContainer.findFirst({where:{botijaoNumero:o}});if(m)return a.status(400).json({error:"J\xe1 existe um botij\xe3o com este n\xfamero"});let p=await d.semenContainer.create({data:{botijaoNumero:o,marca:r||"",modelo:t||"",capacidade:parseInt(s)||500,dataAquisicao:i?new Date(i):null,temperatura:parseFloat(n)||-196,nivelNitrogeno:parseFloat(c)||100,proximaManutencao:u?new Date(u):null,observacoes:l||"",userId:"default-user-id",status:"ATIVO"}});a.status(201).json({message:"Container registrado com sucesso",id:p.id})}catch(e){console.error("Erro ao criar container:",e),a.status(500).json({error:"Erro interno do servidor"})}else if("PUT"===e.method)try{let{id:o,...r}=e.body;if(!o)return a.status(400).json({error:"ID \xe9 obrigat\xf3rio para atualiza\xe7\xe3o"});let t=await d.semenContainer.update({where:{id:o},data:{...r,updatedAt:new Date}});a.status(200).json({message:"Container atualizado com sucesso",data:t})}catch(e){console.error("Erro ao atualizar container:",e),a.status(500).json({error:"Erro interno do servidor"})}else a.setHeader("Allow",["GET","POST","PUT"]),a.status(405).end(`Method ${e.method} Not Allowed`)}let c=(0,i.l)(r,"default"),u=(0,i.l)(r,"config"),l=new t.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/semen-containers",pathname:"/api/semen-containers",bundlePath:"",filename:""},userland:r})}};var a=require("../../webpack-api-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),o=a.X(0,[4222],()=>__webpack_exec__(1079));module.exports=o})();