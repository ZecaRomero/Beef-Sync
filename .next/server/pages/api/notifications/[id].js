"use strict";(()=>{var e={};e.id=8203,e.ids=[8203],e.modules={3524:e=>{e.exports=require("@prisma/client")},9344:e=>{e.exports=require("jsonwebtoken")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},1030:(e,a,t)=>{t.r(a),t.d(a,{config:()=>l,default:()=>u,routeModule:()=>x});var o={};t.r(o),t.d(o,{default:()=>c});var s=t(1802),i=t(7153),r=t(6249),n=t(7864),d=t(9823);async function handler(e,a){let{method:t}=e,{id:o}=e.query,s=e.user.id;switch(t){case"GET":try{let e=await n._.notification.findFirst({where:{id:o,userId:s},include:{gta:{select:{numero:!0,dataEmissao:!0}}}});if(!e)return a.status(404).json({message:"Notifica\xe7\xe3o n\xe3o encontrada"});a.status(200).json(e)}catch(e){console.error("Get notification error:",e),a.status(500).json({message:"Erro ao buscar notifica\xe7\xe3o"})}break;case"PATCH":try{let{status:t,observacoes:i}=e.body,r={};t&&(r.status=t,"LIDA"!==t||r.dataLida?"RESOLVIDA"!==t||r.dataResolvida||(r.dataResolvida=new Date):r.dataLida=new Date),i&&(r.dados=JSON.stringify({...r.dados?JSON.parse(r.dados):{},observacoes:i}));let d=await n._.notification.updateMany({where:{id:o,userId:s},data:r});if(0===d.count)return a.status(404).json({message:"Notifica\xe7\xe3o n\xe3o encontrada"});a.status(200).json({message:"Notifica\xe7\xe3o atualizada com sucesso"})}catch(e){console.error("Update notification error:",e),a.status(500).json({message:"Erro ao atualizar notifica\xe7\xe3o"})}break;case"DELETE":try{let e=await n._.notification.deleteMany({where:{id:o,userId:s}});if(0===e.count)return a.status(404).json({message:"Notifica\xe7\xe3o n\xe3o encontrada"});a.status(200).json({message:"Notifica\xe7\xe3o exclu\xedda com sucesso"})}catch(e){console.error("Delete notification error:",e),a.status(500).json({message:"Erro ao excluir notifica\xe7\xe3o"})}break;default:a.setHeader("Allow",["GET","PATCH","DELETE"]),a.status(405).end(`Method ${t} Not Allowed`)}}let c=(0,d.QO)(handler),u=(0,r.l)(o,"default"),l=(0,r.l)(o,"config"),x=new s.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/notifications/[id]",pathname:"/api/notifications/[id]",bundlePath:"",filename:""},userland:o})}};var a=require("../../../webpack-api-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),t=a.X(0,[4222,9823],()=>__webpack_exec__(1030));module.exports=t})();