"use strict";(()=>{var e={};e.id=7024,e.ids=[7024],e.modules={3524:e=>{e.exports=require("@prisma/client")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},1549:(e,a,i)=>{i.r(a),i.d(a,{config:()=>u,default:()=>d,routeModule:()=>c});var t={};i.r(t),i.d(t,{default:()=>handler});var r=i(1802),n=i(7153),s=i(6249),o=i(3524);let l=new o.PrismaClient;async function handler(e,a){let{id:i}=e.query;if("DELETE"===e.method)try{let e=parseInt(i);if(isNaN(e))return a.status(400).json({error:"ID da nota fiscal inv\xe1lido"});let t=await l.invoice.findUnique({where:{id:e},include:{animals:!0}});if(!t)return a.status(404).json({error:"Nota fiscal n\xe3o encontrada"});let r=t.animals.map(e=>e.animalId);await l.invoice.delete({where:{id:e}}),r.length>0&&await l.animal.updateMany({where:{id:{in:r}},data:{status:"ATIVO",valorVenda:null}}),a.status(200).json({message:"Nota fiscal exclu\xedda com sucesso",animalsReactivated:r.length})}catch(e){console.error("Erro ao excluir nota fiscal:",e),a.status(500).json({error:"Erro interno do servidor"})}else a.setHeader("Allow",["DELETE"]),a.status(405).end(`Method ${e.method} Not Allowed`)}let d=(0,s.l)(t,"default"),u=(0,s.l)(t,"config"),c=new r.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/invoices/[id]",pathname:"/api/invoices/[id]",bundlePath:"",filename:""},userland:t})}};var a=require("../../../webpack-api-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),i=a.X(0,[4222],()=>__webpack_exec__(1549));module.exports=i})();