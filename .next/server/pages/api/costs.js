"use strict";(()=>{var e={};e.id=2157,e.ids=[2157],e.modules={3524:e=>{e.exports=require("@prisma/client")},9344:e=>{e.exports=require("jsonwebtoken")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3736:(e,a,t)=>{t.r(a),t.d(a,{config:()=>u,default:()=>c,routeModule:()=>m});var r={};t.r(r),t.d(r,{default:()=>l});var s=t(1802),o=t(7153),n=t(8781),i=t(7864),d=t(9823);async function handler(e,a){let{method:t}=e,r=e.user.id;switch(t){case"GET":try{let{animalId:t,startDate:s,endDate:o,tipo:n}=e.query,d={userId:r,...t&&{animalId:t},...n&&{tipo:n},...s&&o&&{data:{gte:new Date(s),lte:new Date(o)}}},l=await i._.cost.findMany({where:d,include:{animal:{select:{id:!0,brinco:!0,nome:!0}}},orderBy:{data:"desc"}});a.status(200).json(l)}catch(e){console.error("Get costs error:",e),a.status(500).json({message:"Erro ao buscar custos"})}break;case"POST":try{let{tipo:t,descricao:s,valor:o,data:n,categoria:d,observacoes:l,animalId:c}=e.body;if(!t||!s||!o||!n)return a.status(400).json({message:"Tipo, descri\xe7\xe3o, valor e data s\xe3o obrigat\xf3rios"});if(c){let e=await i._.animal.findFirst({where:{id:c,userId:r}});if(!e)return a.status(404).json({message:"Animal n\xe3o encontrado"})}let u=await i._.cost.create({data:{tipo:t,descricao:s,valor:parseFloat(o),data:new Date(n),categoria:d,observacoes:l,userId:r,animalId:c||null},include:{animal:{select:{id:!0,brinco:!0,nome:!0}}}});a.status(201).json(u)}catch(e){console.error("Create cost error:",e),a.status(500).json({message:"Erro ao criar custo"})}break;default:a.setHeader("Allow",["GET","POST"]),a.status(405).end(`Method ${t} Not Allowed`)}}let l=(0,d.QO)(handler),c=(0,n.l)(r,"default"),u=(0,n.l)(r,"config"),m=new s.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/costs",pathname:"/api/costs",bundlePath:"",filename:""},userland:r})}};var a=require("../../webpack-api-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),t=a.X(0,[4222,9823],()=>__webpack_exec__(3736));module.exports=t})();