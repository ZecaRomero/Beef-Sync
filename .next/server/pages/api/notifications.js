"use strict";(()=>{var e={};e.id=4437,e.ids=[4437],e.modules={3524:e=>{e.exports=require("@prisma/client")},9344:e=>{e.exports=require("jsonwebtoken")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},4214:(e,a,t)=>{t.r(a),t.d(a,{config:()=>u,default:()=>l,routeModule:()=>f});var r={};t.r(r),t.d(r,{default:()=>c});var o=t(1802),i=t(7153),s=t(6249),n=t(7864),d=t(9823);async function handler(e,a){let{method:t}=e,r=e.user.id;switch(t){case"GET":try{let{status:t,tipo:o,prioridade:i,limit:s=50}=e.query,d={userId:r,...t&&{status:t},...o&&{tipo:o},...i&&{prioridade:i}},c=await n._.notification.findMany({where:d,orderBy:[{prioridade:"desc"},{dataCriacao:"desc"}],take:parseInt(s),include:{gta:{select:{numero:!0,dataEmissao:!0}}}});a.status(200).json(c)}catch(e){console.error("Get notifications error:",e),a.status(500).json({message:"Erro ao buscar notifica\xe7\xf5es"})}break;case"POST":try{let{tipo:t,titulo:o,mensagem:i,prioridade:s,dataAgendada:d,gtaId:c,dados:l}=e.body;if(!t||!o||!i)return a.status(400).json({message:"Tipo, t\xedtulo e mensagem s\xe3o obrigat\xf3rios"});let u=await n._.notification.create({data:{tipo:t,titulo:o,mensagem:i,prioridade:s||"MEDIA",dataAgendada:d?new Date(d):null,gtaId:c,dados:l?JSON.stringify(l):null,userId:r}});a.status(201).json(u)}catch(e){console.error("Create notification error:",e),a.status(500).json({message:"Erro ao criar notifica\xe7\xe3o"})}break;default:a.setHeader("Allow",["GET","POST"]),a.status(405).end(`Method ${t} Not Allowed`)}}let c=(0,d.QO)(handler),l=(0,s.l)(r,"default"),u=(0,s.l)(r,"config"),f=new o.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/notifications",pathname:"/api/notifications",bundlePath:"",filename:""},userland:r})}};var a=require("../../webpack-api-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),t=a.X(0,[4222,9823],()=>__webpack_exec__(4214));module.exports=t})();