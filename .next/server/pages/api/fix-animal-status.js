"use strict";(()=>{var a={};a.id=1741,a.ids=[1741],a.modules={3524:a=>{a.exports=require("@prisma/client")},145:a=>{a.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},333:(a,e,s)=>{s.r(e),s.d(e,{config:()=>l,default:()=>u,routeModule:()=>d});var t={};s.r(t),s.d(t,{default:()=>handler});var r=s(1802),o=s(7153),i=s(6249),n=s(7864);async function handler(a,e){if("POST"!==a.method)return e.status(405).json({message:"Method not allowed"});try{let a=await n._.animal.updateMany({where:{status:"ATIVO",sales:{some:{}}},data:{status:"VENDIDO"}}),s=await n._.animal.updateMany({where:{status:"ATIVO",valorVenda:{not:null}},data:{status:"VENDIDO"}}),t=a.count+s.count;console.log(`✅ ${t} animais tiveram o status corrigido para VENDIDO`),e.status(200).json({success:!0,message:`${t} animais corrigidos com sucesso`,updatedFromSales:a.count,updatedFromValue:s.count,total:t})}catch(a){console.error("❌ Erro ao corrigir status dos animais:",a),e.status(500).json({success:!1,message:"Erro ao corrigir status",error:a.message})}}let u=(0,i.l)(t,"default"),l=(0,i.l)(t,"config"),d=new r.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/fix-animal-status",pathname:"/api/fix-animal-status",bundlePath:"",filename:""},userland:t})},7864:(a,e,s)=>{s.d(e,{_:()=>o});var t=s(3524);let r=globalThis,o=r.prisma||new t.PrismaClient}};var e=require("../../webpack-api-runtime.js");e.C(a);var __webpack_exec__=a=>e(e.s=a),s=e.X(0,[4222],()=>__webpack_exec__(333));module.exports=s})();