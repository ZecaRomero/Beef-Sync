<!DOCTYPE html>
<html>
<head>
    <title>Corre√ß√£o de Acesso - Menu Usu√°rios</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 800px; 
            margin: 50px auto; 
            padding: 20px;
            background: #f5f5f5;
        }
        .container { 
            background: white; 
            padding: 30px; 
            border-radius: 10px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        button { 
            background: #007bff; 
            color: white; 
            border: none; 
            padding: 12px 24px; 
            border-radius: 5px; 
            cursor: pointer; 
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover { background: #0056b3; }
        .success { color: #28a745; font-weight: bold; }
        .error { color: #dc3545; font-weight: bold; }
        .info { color: #17a2b8; }
        pre { background: #f8f9fa; padding: 15px; border-radius: 5px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Corre√ß√£o de Acesso - Menu Usu√°rios</h1>
        <p>Zeca, vamos corrigir o problema do menu "Usu√°rios" de forma simples:</p>
        
        <div id="status"></div>
        
        <h3>Passo 1: Configurar Permiss√µes</h3>
        <button onclick="setupUser()">üîß Configurar Usu√°rio Zeca</button>
        
        <h3>Passo 2: Verificar Configura√ß√£o</h3>
        <button onclick="checkConfig()">üîç Verificar Configura√ß√£o</button>
        
        <h3>Passo 3: Acessar P√°gina de Usu√°rios</h3>
        <button onclick="goToUsers()">üë• Ir para Usu√°rios</button>
        
        <h3>Solu√ß√£o Alternativa</h3>
        <p>Se o bot√£o acima n√£o funcionar, copie e cole esta URL na barra de endere√ßos:</p>
        <pre>http://localhost:3000/users</pre>
        
        <div id="debug"></div>
    </div>

    <script>
        function log(message, type = 'info') {
            const status = document.getElementById('status');
            const color = type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : '#17a2b8';
            status.innerHTML += `<div style="color: ${color}; margin: 5px 0;">${message}</div>`;
        }

        function setupUser() {
            try {
                log('üßπ Limpando dados antigos...', 'info');
                localStorage.clear();
                
                log('üë§ Configurando usu√°rio Zeca...', 'info');
                const zecaUser = {
                    username: 'zeca',
                    name: 'Zeca',
                    role: 'developer',
                    permissions: ['read', 'write', 'delete', 'admin', 'manage_users']
                };
                
                localStorage.setItem('beef-sync-user', JSON.stringify(zecaUser));
                localStorage.setItem('beef_sync_user_name', 'Zeca');
                localStorage.setItem('beef_sync_user_role', 'Desenvolvedor');
                
                log('‚úÖ Usu√°rio configurado com sucesso!', 'success');
                log('üìã Dados salvos: ' + JSON.stringify(zecaUser), 'info');
                
            } catch (error) {
                log('‚ùå Erro ao configurar usu√°rio: ' + error.message, 'error');
            }
        }

        function checkConfig() {
            try {
                const user = JSON.parse(localStorage.getItem('beef-sync-user') || '{}');
                
                if (!user.username) {
                    log('‚ùå Usu√°rio n√£o encontrado. Execute o Passo 1 primeiro.', 'error');
                    return;
                }
                
                log('‚úÖ Usu√°rio encontrado: ' + user.name, 'success');
                log('üîê Fun√ß√£o: ' + user.role, 'info');
                log('üìã Permiss√µes: ' + user.permissions.join(', '), 'info');
                
                const hasPermission = user.permissions.includes('manage_users');
                if (hasPermission) {
                    log('‚úÖ Tem permiss√£o para gerenciar usu√°rios!', 'success');
                } else {
                    log('‚ùå N√£o tem permiss√£o para gerenciar usu√°rios', 'error');
                }
                
            } catch (error) {
                log('‚ùå Erro ao verificar configura√ß√£o: ' + error.message, 'error');
            }
        }

        function goToUsers() {
            try {
                log('üöÄ Redirecionando para p√°gina de usu√°rios...', 'info');
                
                // Tentar diferentes formas de navega√ß√£o
                if (window.location.hostname === 'localhost') {
                    window.location.href = 'http://localhost:3000/users';
                } else {
                    window.location.href = '/users';
                }
                
            } catch (error) {
                log('‚ùå Erro ao redirecionar: ' + error.message, 'error');
                log('üí° Tente copiar a URL manualmente: http://localhost:3000/users', 'info');
            }
        }

        // Executar verifica√ß√£o inicial
        window.onload = function() {
            log('üîç Verificando estado atual...', 'info');
            
            const user = localStorage.getItem('beef-sync-user');
            if (user) {
                log('üë§ Usu√°rio j√° configurado', 'success');
                checkConfig();
            } else {
                log('‚ö†Ô∏è Usu√°rio n√£o configurado. Execute o Passo 1.', 'error');
            }
        };
    </script>
</body>
</html>